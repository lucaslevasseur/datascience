{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "fe057f0d",
   "metadata": {},
   "source": [
    "## **Import libraries and data**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "6d3f9bbb",
   "metadata": {},
   "outputs": [],
   "source": [
    "import sklearn \n",
    "import pandas as pd  \n",
    "import matplotlib.pyplot as plt\n",
    "import requests\n",
    "from datetime import datetime, timedelta\n",
    "from dateutil.relativedelta import relativedelta\n",
    "\n",
    "import warnings\n",
    "warnings.simplefilter(action='ignore', category=FutureWarning)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f80192b1",
   "metadata": {},
   "source": [
    "## Cut the request in multiple requests (month per month)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "e8ddf3bf",
   "metadata": {},
   "outputs": [],
   "source": [
    "def generate_monthly_ranges(start_date, end_date):\n",
    "    # Parse the input start and end dates\n",
    "    start = datetime.strptime(start_date, \"%Y-%m-%dT%H:%M\")\n",
    "    end = datetime.strptime(end_date, \"%Y-%m-%dT%H:%M\")\n",
    "    \n",
    "    # Initialize the first month start and end dates\n",
    "    current_start = start\n",
    "    \n",
    "    while current_start <= end:\n",
    "        # Get the last day of the current month\n",
    "        current_end = (current_start + relativedelta(months=1) - timedelta(days=1)).replace(hour=23)\n",
    "        \n",
    "        # Ensure we don't go past the actual end date\n",
    "        if current_end > end:\n",
    "            current_end = end\n",
    "        \n",
    "        # Format as required for the API request\n",
    "        yield current_start.strftime(\"%Y-%m-%dT%H:%M\"), current_end.strftime(\"%Y-%m-%dT%H:%M\")\n",
    "        \n",
    "        # Move to the next month\n",
    "        current_start = (current_start + relativedelta(months=1)).replace(hour=0)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a01f444f",
   "metadata": {},
   "source": [
    "## API request"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "463541da",
   "metadata": {},
   "outputs": [],
   "source": [
    "API_TOKEN = 'fb3872756c312e32fa40585dbbbbc3c156261c2bfc734f2adfc6d6cfd9c7dd93' #Requested by email\n",
    "URL_BASE = 'https://api.esios.ree.es/'\n",
    "ENDPOINT = 'indicators/'\n",
    "start_date = '2014-01-01T00:00'\n",
    "end_date = '2024-02-12T23:00'\n",
    "\n",
    "headers = {'Host': 'api.esios.ree.es',\n",
    "           'x-api-key': API_TOKEN}"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "97c77da7",
   "metadata": {},
   "source": [
    "### Datas other than PBF \n",
    "Price DA (Mercado SPOT): 600 \\\n",
    "Generación prevista Solar: 10034 \\\n",
    "Previsión de la producción eólica peninsular: 541 \\\n",
    "Generación prevista Solar térmica: 543 \\\n",
    "Demanda prevista: 544 \\\n",
    "Demanda programada: 545\n",
    "\n",
    "The scale is hour per hour"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "af5ad100",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "600\n",
      "2014-01-01T00:00 2014-01-31T23:00\n",
      "2014-02-01T00:00 2014-02-28T23:00\n",
      "2014-03-01T00:00 2014-03-31T23:00\n",
      "2014-04-01T00:00 2014-04-30T23:00\n",
      "2014-05-01T00:00 2014-05-31T23:00\n",
      "2014-06-01T00:00 2014-06-30T23:00\n",
      "2014-07-01T00:00 2014-07-31T23:00\n",
      "2014-08-01T00:00 2014-08-31T23:00\n",
      "2014-09-01T00:00 2014-09-30T23:00\n",
      "2014-10-01T00:00 2014-10-31T23:00\n",
      "2014-11-01T00:00 2014-11-30T23:00\n",
      "2014-12-01T00:00 2014-12-31T23:00\n",
      "2015-01-01T00:00 2015-01-31T23:00\n",
      "2015-02-01T00:00 2015-02-28T23:00\n",
      "2015-03-01T00:00 2015-03-31T23:00\n",
      "2015-04-01T00:00 2015-04-30T23:00\n",
      "2015-05-01T00:00 2015-05-31T23:00\n",
      "2015-06-01T00:00 2015-06-30T23:00\n",
      "2015-07-01T00:00 2015-07-31T23:00\n",
      "2015-08-01T00:00 2015-08-31T23:00\n",
      "2015-09-01T00:00 2015-09-30T23:00\n",
      "2015-10-01T00:00 2015-10-31T23:00\n",
      "2015-11-01T00:00 2015-11-30T23:00\n",
      "2015-12-01T00:00 2015-12-31T23:00\n",
      "2016-01-01T00:00 2016-01-31T23:00\n",
      "2016-02-01T00:00 2016-02-29T23:00\n",
      "2016-03-01T00:00 2016-03-31T23:00\n",
      "2016-04-01T00:00 2016-04-30T23:00\n",
      "2016-05-01T00:00 2016-05-31T23:00\n",
      "2016-06-01T00:00 2016-06-30T23:00\n",
      "2016-07-01T00:00 2016-07-31T23:00\n",
      "2016-08-01T00:00 2016-08-31T23:00\n",
      "2016-09-01T00:00 2016-09-30T23:00\n",
      "2016-10-01T00:00 2016-10-31T23:00\n",
      "2016-11-01T00:00 2016-11-30T23:00\n",
      "2016-12-01T00:00 2016-12-31T23:00\n",
      "2017-01-01T00:00 2017-01-31T23:00\n",
      "2017-02-01T00:00 2017-02-28T23:00\n",
      "2017-03-01T00:00 2017-03-31T23:00\n",
      "2017-04-01T00:00 2017-04-30T23:00\n",
      "2017-05-01T00:00 2017-05-31T23:00\n",
      "2017-06-01T00:00 2017-06-30T23:00\n",
      "2017-07-01T00:00 2017-07-31T23:00\n",
      "2017-08-01T00:00 2017-08-31T23:00\n",
      "2017-09-01T00:00 2017-09-30T23:00\n",
      "2017-10-01T00:00 2017-10-31T23:00\n",
      "2017-11-01T00:00 2017-11-30T23:00\n",
      "2017-12-01T00:00 2017-12-31T23:00\n",
      "2018-01-01T00:00 2018-01-31T23:00\n",
      "2018-02-01T00:00 2018-02-28T23:00\n",
      "2018-03-01T00:00 2018-03-31T23:00\n",
      "2018-04-01T00:00 2018-04-30T23:00\n",
      "2018-05-01T00:00 2018-05-31T23:00\n",
      "2018-06-01T00:00 2018-06-30T23:00\n",
      "2018-07-01T00:00 2018-07-31T23:00\n",
      "2018-08-01T00:00 2018-08-31T23:00\n",
      "2018-09-01T00:00 2018-09-30T23:00\n",
      "2018-10-01T00:00 2018-10-31T23:00\n",
      "2018-11-01T00:00 2018-11-30T23:00\n",
      "2018-12-01T00:00 2018-12-31T23:00\n",
      "2019-01-01T00:00 2019-01-31T23:00\n",
      "2019-02-01T00:00 2019-02-28T23:00\n",
      "2019-03-01T00:00 2019-03-31T23:00\n",
      "2019-04-01T00:00 2019-04-30T23:00\n",
      "2019-05-01T00:00 2019-05-31T23:00\n",
      "2019-06-01T00:00 2019-06-30T23:00\n",
      "2019-07-01T00:00 2019-07-31T23:00\n",
      "2019-08-01T00:00 2019-08-31T23:00\n",
      "2019-09-01T00:00 2019-09-30T23:00\n",
      "2019-10-01T00:00 2019-10-31T23:00\n",
      "2019-11-01T00:00 2019-11-30T23:00\n",
      "2019-12-01T00:00 2019-12-31T23:00\n",
      "2020-01-01T00:00 2020-01-31T23:00\n",
      "2020-02-01T00:00 2020-02-29T23:00\n",
      "2020-03-01T00:00 2020-03-31T23:00\n",
      "2020-04-01T00:00 2020-04-30T23:00\n",
      "2020-05-01T00:00 2020-05-31T23:00\n",
      "2020-06-01T00:00 2020-06-30T23:00\n",
      "2020-07-01T00:00 2020-07-31T23:00\n",
      "2020-08-01T00:00 2020-08-31T23:00\n",
      "2020-09-01T00:00 2020-09-30T23:00\n",
      "2020-10-01T00:00 2020-10-31T23:00\n",
      "2020-11-01T00:00 2020-11-30T23:00\n",
      "2020-12-01T00:00 2020-12-31T23:00\n",
      "2021-01-01T00:00 2021-01-31T23:00\n",
      "2021-02-01T00:00 2021-02-28T23:00\n",
      "2021-03-01T00:00 2021-03-31T23:00\n",
      "2021-04-01T00:00 2021-04-30T23:00\n",
      "2021-05-01T00:00 2021-05-31T23:00\n",
      "2021-06-01T00:00 2021-06-30T23:00\n",
      "2021-07-01T00:00 2021-07-31T23:00\n",
      "2021-08-01T00:00 2021-08-31T23:00\n",
      "2021-09-01T00:00 2021-09-30T23:00\n",
      "2021-10-01T00:00 2021-10-31T23:00\n",
      "2021-11-01T00:00 2021-11-30T23:00\n",
      "2021-12-01T00:00 2021-12-31T23:00\n",
      "2022-01-01T00:00 2022-01-31T23:00\n",
      "2022-02-01T00:00 2022-02-28T23:00\n",
      "2022-03-01T00:00 2022-03-31T23:00\n",
      "2022-04-01T00:00 2022-04-30T23:00\n",
      "2022-05-01T00:00 2022-05-31T23:00\n",
      "2022-06-01T00:00 2022-06-30T23:00\n",
      "2022-07-01T00:00 2022-07-31T23:00\n",
      "2022-08-01T00:00 2022-08-31T23:00\n",
      "2022-09-01T00:00 2022-09-30T23:00\n",
      "2022-10-01T00:00 2022-10-31T23:00\n",
      "2022-11-01T00:00 2022-11-30T23:00\n",
      "2022-12-01T00:00 2022-12-31T23:00\n",
      "2023-01-01T00:00 2023-01-31T23:00\n",
      "2023-02-01T00:00 2023-02-28T23:00\n",
      "2023-03-01T00:00 2023-03-31T23:00\n",
      "2023-04-01T00:00 2023-04-30T23:00\n",
      "2023-05-01T00:00 2023-05-31T23:00\n",
      "2023-06-01T00:00 2023-06-30T23:00\n",
      "2023-07-01T00:00 2023-07-31T23:00\n",
      "2023-08-01T00:00 2023-08-31T23:00\n",
      "2023-09-01T00:00 2023-09-30T23:00\n",
      "2023-10-01T00:00 2023-10-31T23:00\n",
      "2023-11-01T00:00 2023-11-30T23:00\n",
      "2023-12-01T00:00 2023-12-31T23:00\n",
      "2024-01-01T00:00 2024-01-31T23:00\n",
      "2024-02-01T00:00 2024-02-12T23:00\n",
      "10034\n",
      "2014-01-01T00:00 2014-01-31T23:00\n",
      "2014-02-01T00:00 2014-02-28T23:00\n",
      "2014-03-01T00:00 2014-03-31T23:00\n",
      "2014-04-01T00:00 2014-04-30T23:00\n",
      "2014-05-01T00:00 2014-05-31T23:00\n",
      "2014-06-01T00:00 2014-06-30T23:00\n",
      "2014-07-01T00:00 2014-07-31T23:00\n",
      "2014-08-01T00:00 2014-08-31T23:00\n",
      "2014-09-01T00:00 2014-09-30T23:00\n",
      "2014-10-01T00:00 2014-10-31T23:00\n",
      "2014-11-01T00:00 2014-11-30T23:00\n",
      "2014-12-01T00:00 2014-12-31T23:00\n",
      "2015-01-01T00:00 2015-01-31T23:00\n",
      "2015-02-01T00:00 2015-02-28T23:00\n",
      "2015-03-01T00:00 2015-03-31T23:00\n",
      "2015-04-01T00:00 2015-04-30T23:00\n",
      "2015-05-01T00:00 2015-05-31T23:00\n",
      "2015-06-01T00:00 2015-06-30T23:00\n",
      "2015-07-01T00:00 2015-07-31T23:00\n",
      "2015-08-01T00:00 2015-08-31T23:00\n",
      "2015-09-01T00:00 2015-09-30T23:00\n",
      "2015-10-01T00:00 2015-10-31T23:00\n",
      "2015-11-01T00:00 2015-11-30T23:00\n",
      "2015-12-01T00:00 2015-12-31T23:00\n",
      "2016-01-01T00:00 2016-01-31T23:00\n",
      "2016-02-01T00:00 2016-02-29T23:00\n",
      "2016-03-01T00:00 2016-03-31T23:00\n",
      "2016-04-01T00:00 2016-04-30T23:00\n",
      "2016-05-01T00:00 2016-05-31T23:00\n",
      "2016-06-01T00:00 2016-06-30T23:00\n",
      "2016-07-01T00:00 2016-07-31T23:00\n",
      "2016-08-01T00:00 2016-08-31T23:00\n",
      "2016-09-01T00:00 2016-09-30T23:00\n",
      "2016-10-01T00:00 2016-10-31T23:00\n",
      "2016-11-01T00:00 2016-11-30T23:00\n",
      "2016-12-01T00:00 2016-12-31T23:00\n",
      "2017-01-01T00:00 2017-01-31T23:00\n",
      "2017-02-01T00:00 2017-02-28T23:00\n",
      "2017-03-01T00:00 2017-03-31T23:00\n",
      "2017-04-01T00:00 2017-04-30T23:00\n",
      "2017-05-01T00:00 2017-05-31T23:00\n",
      "2017-06-01T00:00 2017-06-30T23:00\n",
      "2017-07-01T00:00 2017-07-31T23:00\n",
      "2017-08-01T00:00 2017-08-31T23:00\n",
      "2017-09-01T00:00 2017-09-30T23:00\n",
      "2017-10-01T00:00 2017-10-31T23:00\n",
      "2017-11-01T00:00 2017-11-30T23:00\n",
      "2017-12-01T00:00 2017-12-31T23:00\n",
      "2018-01-01T00:00 2018-01-31T23:00\n",
      "2018-02-01T00:00 2018-02-28T23:00\n",
      "2018-03-01T00:00 2018-03-31T23:00\n",
      "2018-04-01T00:00 2018-04-30T23:00\n",
      "2018-05-01T00:00 2018-05-31T23:00\n",
      "2018-06-01T00:00 2018-06-30T23:00\n",
      "2018-07-01T00:00 2018-07-31T23:00\n",
      "2018-08-01T00:00 2018-08-31T23:00\n",
      "2018-09-01T00:00 2018-09-30T23:00\n",
      "2018-10-01T00:00 2018-10-31T23:00\n",
      "2018-11-01T00:00 2018-11-30T23:00\n",
      "2018-12-01T00:00 2018-12-31T23:00\n",
      "2019-01-01T00:00 2019-01-31T23:00\n",
      "2019-02-01T00:00 2019-02-28T23:00\n",
      "2019-03-01T00:00 2019-03-31T23:00\n",
      "2019-04-01T00:00 2019-04-30T23:00\n",
      "2019-05-01T00:00 2019-05-31T23:00\n",
      "2019-06-01T00:00 2019-06-30T23:00\n",
      "2019-07-01T00:00 2019-07-31T23:00\n",
      "2019-08-01T00:00 2019-08-31T23:00\n",
      "2019-09-01T00:00 2019-09-30T23:00\n",
      "2019-10-01T00:00 2019-10-31T23:00\n",
      "2019-11-01T00:00 2019-11-30T23:00\n",
      "2019-12-01T00:00 2019-12-31T23:00\n",
      "2020-01-01T00:00 2020-01-31T23:00\n",
      "2020-02-01T00:00 2020-02-29T23:00\n",
      "2020-03-01T00:00 2020-03-31T23:00\n",
      "2020-04-01T00:00 2020-04-30T23:00\n",
      "2020-05-01T00:00 2020-05-31T23:00\n",
      "2020-06-01T00:00 2020-06-30T23:00\n",
      "2020-07-01T00:00 2020-07-31T23:00\n",
      "2020-08-01T00:00 2020-08-31T23:00\n",
      "2020-09-01T00:00 2020-09-30T23:00\n",
      "2020-10-01T00:00 2020-10-31T23:00\n",
      "2020-11-01T00:00 2020-11-30T23:00\n",
      "2020-12-01T00:00 2020-12-31T23:00\n",
      "2021-01-01T00:00 2021-01-31T23:00\n",
      "2021-02-01T00:00 2021-02-28T23:00\n",
      "2021-03-01T00:00 2021-03-31T23:00\n",
      "2021-04-01T00:00 2021-04-30T23:00\n",
      "2021-05-01T00:00 2021-05-31T23:00\n",
      "2021-06-01T00:00 2021-06-30T23:00\n",
      "2021-07-01T00:00 2021-07-31T23:00\n",
      "2021-08-01T00:00 2021-08-31T23:00\n",
      "2021-09-01T00:00 2021-09-30T23:00\n",
      "2021-10-01T00:00 2021-10-31T23:00\n",
      "2021-11-01T00:00 2021-11-30T23:00\n",
      "2021-12-01T00:00 2021-12-31T23:00\n",
      "2022-01-01T00:00 2022-01-31T23:00\n",
      "2022-02-01T00:00 2022-02-28T23:00\n",
      "2022-03-01T00:00 2022-03-31T23:00\n",
      "2022-04-01T00:00 2022-04-30T23:00\n",
      "2022-05-01T00:00 2022-05-31T23:00\n",
      "2022-06-01T00:00 2022-06-30T23:00\n",
      "2022-07-01T00:00 2022-07-31T23:00\n",
      "2022-08-01T00:00 2022-08-31T23:00\n",
      "2022-09-01T00:00 2022-09-30T23:00\n",
      "2022-10-01T00:00 2022-10-31T23:00\n",
      "2022-11-01T00:00 2022-11-30T23:00\n",
      "2022-12-01T00:00 2022-12-31T23:00\n",
      "2023-01-01T00:00 2023-01-31T23:00\n",
      "2023-02-01T00:00 2023-02-28T23:00\n",
      "2023-03-01T00:00 2023-03-31T23:00\n",
      "2023-04-01T00:00 2023-04-30T23:00\n",
      "2023-05-01T00:00 2023-05-31T23:00\n",
      "2023-06-01T00:00 2023-06-30T23:00\n",
      "2023-07-01T00:00 2023-07-31T23:00\n",
      "2023-08-01T00:00 2023-08-31T23:00\n",
      "2023-09-01T00:00 2023-09-30T23:00\n",
      "2023-10-01T00:00 2023-10-31T23:00\n",
      "2023-11-01T00:00 2023-11-30T23:00\n",
      "2023-12-01T00:00 2023-12-31T23:00\n",
      "2024-01-01T00:00 2024-01-31T23:00\n",
      "2024-02-01T00:00 2024-02-12T23:00\n",
      "541\n",
      "2014-01-01T00:00 2014-01-31T23:00\n",
      "2014-02-01T00:00 2014-02-28T23:00\n",
      "2014-03-01T00:00 2014-03-31T23:00\n",
      "2014-04-01T00:00 2014-04-30T23:00\n",
      "2014-05-01T00:00 2014-05-31T23:00\n",
      "2014-06-01T00:00 2014-06-30T23:00\n",
      "2014-07-01T00:00 2014-07-31T23:00\n",
      "2014-08-01T00:00 2014-08-31T23:00\n",
      "2014-09-01T00:00 2014-09-30T23:00\n",
      "2014-10-01T00:00 2014-10-31T23:00\n",
      "2014-11-01T00:00 2014-11-30T23:00\n",
      "2014-12-01T00:00 2014-12-31T23:00\n",
      "2015-01-01T00:00 2015-01-31T23:00\n",
      "2015-02-01T00:00 2015-02-28T23:00\n",
      "2015-03-01T00:00 2015-03-31T23:00\n",
      "2015-04-01T00:00 2015-04-30T23:00\n",
      "2015-05-01T00:00 2015-05-31T23:00\n",
      "2015-06-01T00:00 2015-06-30T23:00\n",
      "2015-07-01T00:00 2015-07-31T23:00\n",
      "2015-08-01T00:00 2015-08-31T23:00\n",
      "2015-09-01T00:00 2015-09-30T23:00\n",
      "2015-10-01T00:00 2015-10-31T23:00\n",
      "2015-11-01T00:00 2015-11-30T23:00\n",
      "2015-12-01T00:00 2015-12-31T23:00\n",
      "2016-01-01T00:00 2016-01-31T23:00\n",
      "2016-02-01T00:00 2016-02-29T23:00\n",
      "2016-03-01T00:00 2016-03-31T23:00\n",
      "2016-04-01T00:00 2016-04-30T23:00\n",
      "2016-05-01T00:00 2016-05-31T23:00\n",
      "2016-06-01T00:00 2016-06-30T23:00\n",
      "2016-07-01T00:00 2016-07-31T23:00\n",
      "2016-08-01T00:00 2016-08-31T23:00\n",
      "2016-09-01T00:00 2016-09-30T23:00\n",
      "2016-10-01T00:00 2016-10-31T23:00\n",
      "2016-11-01T00:00 2016-11-30T23:00\n",
      "2016-12-01T00:00 2016-12-31T23:00\n",
      "2017-01-01T00:00 2017-01-31T23:00\n",
      "2017-02-01T00:00 2017-02-28T23:00\n",
      "2017-03-01T00:00 2017-03-31T23:00\n",
      "2017-04-01T00:00 2017-04-30T23:00\n",
      "2017-05-01T00:00 2017-05-31T23:00\n",
      "2017-06-01T00:00 2017-06-30T23:00\n",
      "2017-07-01T00:00 2017-07-31T23:00\n",
      "2017-08-01T00:00 2017-08-31T23:00\n",
      "2017-09-01T00:00 2017-09-30T23:00\n",
      "2017-10-01T00:00 2017-10-31T23:00\n",
      "2017-11-01T00:00 2017-11-30T23:00\n",
      "2017-12-01T00:00 2017-12-31T23:00\n",
      "2018-01-01T00:00 2018-01-31T23:00\n",
      "2018-02-01T00:00 2018-02-28T23:00\n",
      "2018-03-01T00:00 2018-03-31T23:00\n",
      "2018-04-01T00:00 2018-04-30T23:00\n",
      "2018-05-01T00:00 2018-05-31T23:00\n",
      "2018-06-01T00:00 2018-06-30T23:00\n",
      "2018-07-01T00:00 2018-07-31T23:00\n",
      "2018-08-01T00:00 2018-08-31T23:00\n",
      "2018-09-01T00:00 2018-09-30T23:00\n",
      "2018-10-01T00:00 2018-10-31T23:00\n",
      "2018-11-01T00:00 2018-11-30T23:00\n",
      "2018-12-01T00:00 2018-12-31T23:00\n",
      "2019-01-01T00:00 2019-01-31T23:00\n",
      "2019-02-01T00:00 2019-02-28T23:00\n",
      "2019-03-01T00:00 2019-03-31T23:00\n",
      "2019-04-01T00:00 2019-04-30T23:00\n",
      "2019-05-01T00:00 2019-05-31T23:00\n",
      "2019-06-01T00:00 2019-06-30T23:00\n",
      "2019-07-01T00:00 2019-07-31T23:00\n",
      "2019-08-01T00:00 2019-08-31T23:00\n",
      "2019-09-01T00:00 2019-09-30T23:00\n",
      "2019-10-01T00:00 2019-10-31T23:00\n",
      "2019-11-01T00:00 2019-11-30T23:00\n",
      "2019-12-01T00:00 2019-12-31T23:00\n",
      "2020-01-01T00:00 2020-01-31T23:00\n",
      "2020-02-01T00:00 2020-02-29T23:00\n",
      "2020-03-01T00:00 2020-03-31T23:00\n",
      "2020-04-01T00:00 2020-04-30T23:00\n",
      "2020-05-01T00:00 2020-05-31T23:00\n",
      "2020-06-01T00:00 2020-06-30T23:00\n",
      "2020-07-01T00:00 2020-07-31T23:00\n",
      "2020-08-01T00:00 2020-08-31T23:00\n",
      "2020-09-01T00:00 2020-09-30T23:00\n",
      "2020-10-01T00:00 2020-10-31T23:00\n",
      "2020-11-01T00:00 2020-11-30T23:00\n",
      "2020-12-01T00:00 2020-12-31T23:00\n",
      "2021-01-01T00:00 2021-01-31T23:00\n",
      "2021-02-01T00:00 2021-02-28T23:00\n",
      "2021-03-01T00:00 2021-03-31T23:00\n",
      "2021-04-01T00:00 2021-04-30T23:00\n",
      "2021-05-01T00:00 2021-05-31T23:00\n",
      "2021-06-01T00:00 2021-06-30T23:00\n",
      "2021-07-01T00:00 2021-07-31T23:00\n",
      "2021-08-01T00:00 2021-08-31T23:00\n",
      "2021-09-01T00:00 2021-09-30T23:00\n",
      "2021-10-01T00:00 2021-10-31T23:00\n",
      "2021-11-01T00:00 2021-11-30T23:00\n",
      "2021-12-01T00:00 2021-12-31T23:00\n",
      "2022-01-01T00:00 2022-01-31T23:00\n",
      "2022-02-01T00:00 2022-02-28T23:00\n",
      "2022-03-01T00:00 2022-03-31T23:00\n",
      "2022-04-01T00:00 2022-04-30T23:00\n",
      "2022-05-01T00:00 2022-05-31T23:00\n",
      "2022-06-01T00:00 2022-06-30T23:00\n",
      "2022-07-01T00:00 2022-07-31T23:00\n",
      "2022-08-01T00:00 2022-08-31T23:00\n",
      "2022-09-01T00:00 2022-09-30T23:00\n",
      "2022-10-01T00:00 2022-10-31T23:00\n",
      "2022-11-01T00:00 2022-11-30T23:00\n",
      "2022-12-01T00:00 2022-12-31T23:00\n",
      "2023-01-01T00:00 2023-01-31T23:00\n",
      "2023-02-01T00:00 2023-02-28T23:00\n",
      "2023-03-01T00:00 2023-03-31T23:00\n",
      "2023-04-01T00:00 2023-04-30T23:00\n",
      "2023-05-01T00:00 2023-05-31T23:00\n",
      "2023-06-01T00:00 2023-06-30T23:00\n",
      "2023-07-01T00:00 2023-07-31T23:00\n",
      "2023-08-01T00:00 2023-08-31T23:00\n",
      "2023-09-01T00:00 2023-09-30T23:00\n",
      "2023-10-01T00:00 2023-10-31T23:00\n",
      "2023-11-01T00:00 2023-11-30T23:00\n",
      "2023-12-01T00:00 2023-12-31T23:00\n",
      "2024-01-01T00:00 2024-01-31T23:00\n",
      "2024-02-01T00:00 2024-02-12T23:00\n",
      "543\n",
      "2014-01-01T00:00 2014-01-31T23:00\n",
      "2014-02-01T00:00 2014-02-28T23:00\n",
      "2014-03-01T00:00 2014-03-31T23:00\n",
      "2014-04-01T00:00 2014-04-30T23:00\n",
      "2014-05-01T00:00 2014-05-31T23:00\n",
      "2014-06-01T00:00 2014-06-30T23:00\n",
      "2014-07-01T00:00 2014-07-31T23:00\n",
      "2014-08-01T00:00 2014-08-31T23:00\n",
      "2014-09-01T00:00 2014-09-30T23:00\n",
      "2014-10-01T00:00 2014-10-31T23:00\n",
      "2014-11-01T00:00 2014-11-30T23:00\n",
      "2014-12-01T00:00 2014-12-31T23:00\n",
      "2015-01-01T00:00 2015-01-31T23:00\n",
      "2015-02-01T00:00 2015-02-28T23:00\n",
      "2015-03-01T00:00 2015-03-31T23:00\n",
      "2015-04-01T00:00 2015-04-30T23:00\n",
      "2015-05-01T00:00 2015-05-31T23:00\n",
      "2015-06-01T00:00 2015-06-30T23:00\n",
      "2015-07-01T00:00 2015-07-31T23:00\n",
      "2015-08-01T00:00 2015-08-31T23:00\n",
      "2015-09-01T00:00 2015-09-30T23:00\n",
      "2015-10-01T00:00 2015-10-31T23:00\n",
      "2015-11-01T00:00 2015-11-30T23:00\n",
      "2015-12-01T00:00 2015-12-31T23:00\n",
      "2016-01-01T00:00 2016-01-31T23:00\n",
      "2016-02-01T00:00 2016-02-29T23:00\n",
      "2016-03-01T00:00 2016-03-31T23:00\n",
      "2016-04-01T00:00 2016-04-30T23:00\n",
      "2016-05-01T00:00 2016-05-31T23:00\n",
      "2016-06-01T00:00 2016-06-30T23:00\n",
      "2016-07-01T00:00 2016-07-31T23:00\n",
      "2016-08-01T00:00 2016-08-31T23:00\n",
      "2016-09-01T00:00 2016-09-30T23:00\n",
      "2016-10-01T00:00 2016-10-31T23:00\n",
      "2016-11-01T00:00 2016-11-30T23:00\n",
      "2016-12-01T00:00 2016-12-31T23:00\n",
      "2017-01-01T00:00 2017-01-31T23:00\n",
      "2017-02-01T00:00 2017-02-28T23:00\n",
      "2017-03-01T00:00 2017-03-31T23:00\n",
      "2017-04-01T00:00 2017-04-30T23:00\n",
      "2017-05-01T00:00 2017-05-31T23:00\n",
      "2017-06-01T00:00 2017-06-30T23:00\n",
      "2017-07-01T00:00 2017-07-31T23:00\n",
      "2017-08-01T00:00 2017-08-31T23:00\n",
      "2017-09-01T00:00 2017-09-30T23:00\n",
      "2017-10-01T00:00 2017-10-31T23:00\n",
      "2017-11-01T00:00 2017-11-30T23:00\n",
      "2017-12-01T00:00 2017-12-31T23:00\n",
      "2018-01-01T00:00 2018-01-31T23:00\n",
      "2018-02-01T00:00 2018-02-28T23:00\n",
      "2018-03-01T00:00 2018-03-31T23:00\n",
      "2018-04-01T00:00 2018-04-30T23:00\n",
      "2018-05-01T00:00 2018-05-31T23:00\n",
      "2018-06-01T00:00 2018-06-30T23:00\n",
      "2018-07-01T00:00 2018-07-31T23:00\n",
      "2018-08-01T00:00 2018-08-31T23:00\n",
      "2018-09-01T00:00 2018-09-30T23:00\n",
      "2018-10-01T00:00 2018-10-31T23:00\n",
      "2018-11-01T00:00 2018-11-30T23:00\n",
      "2018-12-01T00:00 2018-12-31T23:00\n",
      "2019-01-01T00:00 2019-01-31T23:00\n",
      "2019-02-01T00:00 2019-02-28T23:00\n",
      "2019-03-01T00:00 2019-03-31T23:00\n",
      "2019-04-01T00:00 2019-04-30T23:00\n",
      "2019-05-01T00:00 2019-05-31T23:00\n",
      "2019-06-01T00:00 2019-06-30T23:00\n",
      "2019-07-01T00:00 2019-07-31T23:00\n",
      "2019-08-01T00:00 2019-08-31T23:00\n",
      "2019-09-01T00:00 2019-09-30T23:00\n",
      "2019-10-01T00:00 2019-10-31T23:00\n",
      "2019-11-01T00:00 2019-11-30T23:00\n",
      "2019-12-01T00:00 2019-12-31T23:00\n",
      "2020-01-01T00:00 2020-01-31T23:00\n",
      "2020-02-01T00:00 2020-02-29T23:00\n",
      "2020-03-01T00:00 2020-03-31T23:00\n",
      "2020-04-01T00:00 2020-04-30T23:00\n",
      "2020-05-01T00:00 2020-05-31T23:00\n",
      "2020-06-01T00:00 2020-06-30T23:00\n",
      "2020-07-01T00:00 2020-07-31T23:00\n",
      "2020-08-01T00:00 2020-08-31T23:00\n",
      "2020-09-01T00:00 2020-09-30T23:00\n",
      "2020-10-01T00:00 2020-10-31T23:00\n",
      "2020-11-01T00:00 2020-11-30T23:00\n",
      "2020-12-01T00:00 2020-12-31T23:00\n",
      "2021-01-01T00:00 2021-01-31T23:00\n",
      "2021-02-01T00:00 2021-02-28T23:00\n",
      "2021-03-01T00:00 2021-03-31T23:00\n",
      "2021-04-01T00:00 2021-04-30T23:00\n",
      "2021-05-01T00:00 2021-05-31T23:00\n",
      "2021-06-01T00:00 2021-06-30T23:00\n",
      "2021-07-01T00:00 2021-07-31T23:00\n",
      "2021-08-01T00:00 2021-08-31T23:00\n",
      "2021-09-01T00:00 2021-09-30T23:00\n",
      "2021-10-01T00:00 2021-10-31T23:00\n",
      "2021-11-01T00:00 2021-11-30T23:00\n",
      "2021-12-01T00:00 2021-12-31T23:00\n",
      "2022-01-01T00:00 2022-01-31T23:00\n",
      "2022-02-01T00:00 2022-02-28T23:00\n",
      "2022-03-01T00:00 2022-03-31T23:00\n",
      "2022-04-01T00:00 2022-04-30T23:00\n",
      "2022-05-01T00:00 2022-05-31T23:00\n",
      "2022-06-01T00:00 2022-06-30T23:00\n",
      "2022-07-01T00:00 2022-07-31T23:00\n",
      "2022-08-01T00:00 2022-08-31T23:00\n",
      "2022-09-01T00:00 2022-09-30T23:00\n",
      "2022-10-01T00:00 2022-10-31T23:00\n",
      "2022-11-01T00:00 2022-11-30T23:00\n",
      "2022-12-01T00:00 2022-12-31T23:00\n",
      "2023-01-01T00:00 2023-01-31T23:00\n",
      "2023-02-01T00:00 2023-02-28T23:00\n",
      "2023-03-01T00:00 2023-03-31T23:00\n",
      "2023-04-01T00:00 2023-04-30T23:00\n",
      "2023-05-01T00:00 2023-05-31T23:00\n",
      "2023-06-01T00:00 2023-06-30T23:00\n",
      "2023-07-01T00:00 2023-07-31T23:00\n",
      "2023-08-01T00:00 2023-08-31T23:00\n",
      "2023-09-01T00:00 2023-09-30T23:00\n",
      "2023-10-01T00:00 2023-10-31T23:00\n",
      "2023-11-01T00:00 2023-11-30T23:00\n",
      "2023-12-01T00:00 2023-12-31T23:00\n",
      "2024-01-01T00:00 2024-01-31T23:00\n",
      "2024-02-01T00:00 2024-02-12T23:00\n",
      "544\n",
      "2014-01-01T00:00 2014-01-31T23:00\n",
      "2014-02-01T00:00 2014-02-28T23:00\n",
      "2014-03-01T00:00 2014-03-31T23:00\n",
      "2014-04-01T00:00 2014-04-30T23:00\n",
      "2014-05-01T00:00 2014-05-31T23:00\n",
      "2014-06-01T00:00 2014-06-30T23:00\n",
      "2014-07-01T00:00 2014-07-31T23:00\n",
      "2014-08-01T00:00 2014-08-31T23:00\n",
      "2014-09-01T00:00 2014-09-30T23:00\n",
      "2014-10-01T00:00 2014-10-31T23:00\n",
      "2014-11-01T00:00 2014-11-30T23:00\n",
      "2014-12-01T00:00 2014-12-31T23:00\n",
      "2015-01-01T00:00 2015-01-31T23:00\n",
      "2015-02-01T00:00 2015-02-28T23:00\n",
      "2015-03-01T00:00 2015-03-31T23:00\n",
      "2015-04-01T00:00 2015-04-30T23:00\n",
      "2015-05-01T00:00 2015-05-31T23:00\n",
      "2015-06-01T00:00 2015-06-30T23:00\n",
      "2015-07-01T00:00 2015-07-31T23:00\n",
      "2015-08-01T00:00 2015-08-31T23:00\n",
      "2015-09-01T00:00 2015-09-30T23:00\n",
      "2015-10-01T00:00 2015-10-31T23:00\n",
      "2015-11-01T00:00 2015-11-30T23:00\n",
      "2015-12-01T00:00 2015-12-31T23:00\n",
      "2016-01-01T00:00 2016-01-31T23:00\n",
      "2016-02-01T00:00 2016-02-29T23:00\n",
      "2016-03-01T00:00 2016-03-31T23:00\n",
      "2016-04-01T00:00 2016-04-30T23:00\n",
      "2016-05-01T00:00 2016-05-31T23:00\n",
      "2016-06-01T00:00 2016-06-30T23:00\n",
      "2016-07-01T00:00 2016-07-31T23:00\n",
      "2016-08-01T00:00 2016-08-31T23:00\n",
      "2016-09-01T00:00 2016-09-30T23:00\n",
      "2016-10-01T00:00 2016-10-31T23:00\n",
      "2016-11-01T00:00 2016-11-30T23:00\n",
      "2016-12-01T00:00 2016-12-31T23:00\n",
      "2017-01-01T00:00 2017-01-31T23:00\n",
      "2017-02-01T00:00 2017-02-28T23:00\n",
      "2017-03-01T00:00 2017-03-31T23:00\n",
      "2017-04-01T00:00 2017-04-30T23:00\n",
      "2017-05-01T00:00 2017-05-31T23:00\n",
      "2017-06-01T00:00 2017-06-30T23:00\n",
      "2017-07-01T00:00 2017-07-31T23:00\n",
      "2017-08-01T00:00 2017-08-31T23:00\n",
      "2017-09-01T00:00 2017-09-30T23:00\n",
      "2017-10-01T00:00 2017-10-31T23:00\n",
      "2017-11-01T00:00 2017-11-30T23:00\n",
      "2017-12-01T00:00 2017-12-31T23:00\n",
      "2018-01-01T00:00 2018-01-31T23:00\n",
      "2018-02-01T00:00 2018-02-28T23:00\n",
      "2018-03-01T00:00 2018-03-31T23:00\n",
      "2018-04-01T00:00 2018-04-30T23:00\n",
      "2018-05-01T00:00 2018-05-31T23:00\n",
      "2018-06-01T00:00 2018-06-30T23:00\n",
      "2018-07-01T00:00 2018-07-31T23:00\n",
      "2018-08-01T00:00 2018-08-31T23:00\n",
      "2018-09-01T00:00 2018-09-30T23:00\n",
      "2018-10-01T00:00 2018-10-31T23:00\n",
      "2018-11-01T00:00 2018-11-30T23:00\n",
      "2018-12-01T00:00 2018-12-31T23:00\n",
      "2019-01-01T00:00 2019-01-31T23:00\n",
      "2019-02-01T00:00 2019-02-28T23:00\n",
      "2019-03-01T00:00 2019-03-31T23:00\n",
      "2019-04-01T00:00 2019-04-30T23:00\n",
      "2019-05-01T00:00 2019-05-31T23:00\n",
      "2019-06-01T00:00 2019-06-30T23:00\n",
      "2019-07-01T00:00 2019-07-31T23:00\n",
      "2019-08-01T00:00 2019-08-31T23:00\n",
      "2019-09-01T00:00 2019-09-30T23:00\n",
      "2019-10-01T00:00 2019-10-31T23:00\n",
      "2019-11-01T00:00 2019-11-30T23:00\n",
      "2019-12-01T00:00 2019-12-31T23:00\n",
      "2020-01-01T00:00 2020-01-31T23:00\n",
      "2020-02-01T00:00 2020-02-29T23:00\n",
      "2020-03-01T00:00 2020-03-31T23:00\n",
      "2020-04-01T00:00 2020-04-30T23:00\n",
      "2020-05-01T00:00 2020-05-31T23:00\n",
      "2020-06-01T00:00 2020-06-30T23:00\n",
      "2020-07-01T00:00 2020-07-31T23:00\n",
      "2020-08-01T00:00 2020-08-31T23:00\n",
      "2020-09-01T00:00 2020-09-30T23:00\n",
      "2020-10-01T00:00 2020-10-31T23:00\n",
      "2020-11-01T00:00 2020-11-30T23:00\n",
      "2020-12-01T00:00 2020-12-31T23:00\n",
      "2021-01-01T00:00 2021-01-31T23:00\n",
      "2021-02-01T00:00 2021-02-28T23:00\n",
      "2021-03-01T00:00 2021-03-31T23:00\n",
      "2021-04-01T00:00 2021-04-30T23:00\n",
      "2021-05-01T00:00 2021-05-31T23:00\n",
      "2021-06-01T00:00 2021-06-30T23:00\n",
      "2021-07-01T00:00 2021-07-31T23:00\n",
      "2021-08-01T00:00 2021-08-31T23:00\n",
      "2021-09-01T00:00 2021-09-30T23:00\n",
      "2021-10-01T00:00 2021-10-31T23:00\n",
      "2021-11-01T00:00 2021-11-30T23:00\n",
      "2021-12-01T00:00 2021-12-31T23:00\n",
      "2022-01-01T00:00 2022-01-31T23:00\n",
      "2022-02-01T00:00 2022-02-28T23:00\n",
      "2022-03-01T00:00 2022-03-31T23:00\n",
      "2022-04-01T00:00 2022-04-30T23:00\n",
      "2022-05-01T00:00 2022-05-31T23:00\n",
      "2022-06-01T00:00 2022-06-30T23:00\n",
      "2022-07-01T00:00 2022-07-31T23:00\n",
      "2022-08-01T00:00 2022-08-31T23:00\n",
      "2022-09-01T00:00 2022-09-30T23:00\n",
      "2022-10-01T00:00 2022-10-31T23:00\n",
      "2022-11-01T00:00 2022-11-30T23:00\n",
      "2022-12-01T00:00 2022-12-31T23:00\n",
      "2023-01-01T00:00 2023-01-31T23:00\n",
      "2023-02-01T00:00 2023-02-28T23:00\n",
      "2023-03-01T00:00 2023-03-31T23:00\n",
      "2023-04-01T00:00 2023-04-30T23:00\n",
      "2023-05-01T00:00 2023-05-31T23:00\n",
      "2023-06-01T00:00 2023-06-30T23:00\n",
      "2023-07-01T00:00 2023-07-31T23:00\n",
      "2023-08-01T00:00 2023-08-31T23:00\n",
      "2023-09-01T00:00 2023-09-30T23:00\n",
      "2023-10-01T00:00 2023-10-31T23:00\n",
      "2023-11-01T00:00 2023-11-30T23:00\n",
      "2023-12-01T00:00 2023-12-31T23:00\n",
      "2024-01-01T00:00 2024-01-31T23:00\n",
      "2024-02-01T00:00 2024-02-12T23:00\n",
      "545\n",
      "2014-01-01T00:00 2014-01-31T23:00\n",
      "2014-02-01T00:00 2014-02-28T23:00\n",
      "2014-03-01T00:00 2014-03-31T23:00\n",
      "2014-04-01T00:00 2014-04-30T23:00\n",
      "2014-05-01T00:00 2014-05-31T23:00\n",
      "2014-06-01T00:00 2014-06-30T23:00\n",
      "2014-07-01T00:00 2014-07-31T23:00\n",
      "2014-08-01T00:00 2014-08-31T23:00\n",
      "2014-09-01T00:00 2014-09-30T23:00\n",
      "2014-10-01T00:00 2014-10-31T23:00\n",
      "2014-11-01T00:00 2014-11-30T23:00\n",
      "2014-12-01T00:00 2014-12-31T23:00\n",
      "2015-01-01T00:00 2015-01-31T23:00\n",
      "2015-02-01T00:00 2015-02-28T23:00\n",
      "2015-03-01T00:00 2015-03-31T23:00\n",
      "2015-04-01T00:00 2015-04-30T23:00\n",
      "2015-05-01T00:00 2015-05-31T23:00\n",
      "2015-06-01T00:00 2015-06-30T23:00\n",
      "2015-07-01T00:00 2015-07-31T23:00\n",
      "2015-08-01T00:00 2015-08-31T23:00\n",
      "2015-09-01T00:00 2015-09-30T23:00\n",
      "2015-10-01T00:00 2015-10-31T23:00\n",
      "2015-11-01T00:00 2015-11-30T23:00\n",
      "2015-12-01T00:00 2015-12-31T23:00\n",
      "2016-01-01T00:00 2016-01-31T23:00\n",
      "2016-02-01T00:00 2016-02-29T23:00\n",
      "2016-03-01T00:00 2016-03-31T23:00\n",
      "2016-04-01T00:00 2016-04-30T23:00\n",
      "2016-05-01T00:00 2016-05-31T23:00\n",
      "2016-06-01T00:00 2016-06-30T23:00\n",
      "2016-07-01T00:00 2016-07-31T23:00\n",
      "2016-08-01T00:00 2016-08-31T23:00\n",
      "2016-09-01T00:00 2016-09-30T23:00\n",
      "2016-10-01T00:00 2016-10-31T23:00\n",
      "2016-11-01T00:00 2016-11-30T23:00\n",
      "2016-12-01T00:00 2016-12-31T23:00\n",
      "2017-01-01T00:00 2017-01-31T23:00\n",
      "2017-02-01T00:00 2017-02-28T23:00\n",
      "2017-03-01T00:00 2017-03-31T23:00\n",
      "2017-04-01T00:00 2017-04-30T23:00\n",
      "2017-05-01T00:00 2017-05-31T23:00\n",
      "2017-06-01T00:00 2017-06-30T23:00\n",
      "2017-07-01T00:00 2017-07-31T23:00\n",
      "2017-08-01T00:00 2017-08-31T23:00\n",
      "2017-09-01T00:00 2017-09-30T23:00\n",
      "2017-10-01T00:00 2017-10-31T23:00\n",
      "2017-11-01T00:00 2017-11-30T23:00\n",
      "2017-12-01T00:00 2017-12-31T23:00\n",
      "2018-01-01T00:00 2018-01-31T23:00\n",
      "2018-02-01T00:00 2018-02-28T23:00\n",
      "2018-03-01T00:00 2018-03-31T23:00\n",
      "2018-04-01T00:00 2018-04-30T23:00\n",
      "2018-05-01T00:00 2018-05-31T23:00\n",
      "2018-06-01T00:00 2018-06-30T23:00\n",
      "2018-07-01T00:00 2018-07-31T23:00\n",
      "2018-08-01T00:00 2018-08-31T23:00\n",
      "2018-09-01T00:00 2018-09-30T23:00\n",
      "2018-10-01T00:00 2018-10-31T23:00\n",
      "2018-11-01T00:00 2018-11-30T23:00\n",
      "2018-12-01T00:00 2018-12-31T23:00\n",
      "2019-01-01T00:00 2019-01-31T23:00\n",
      "2019-02-01T00:00 2019-02-28T23:00\n",
      "2019-03-01T00:00 2019-03-31T23:00\n",
      "2019-04-01T00:00 2019-04-30T23:00\n",
      "2019-05-01T00:00 2019-05-31T23:00\n",
      "2019-06-01T00:00 2019-06-30T23:00\n",
      "2019-07-01T00:00 2019-07-31T23:00\n",
      "2019-08-01T00:00 2019-08-31T23:00\n",
      "2019-09-01T00:00 2019-09-30T23:00\n",
      "2019-10-01T00:00 2019-10-31T23:00\n",
      "2019-11-01T00:00 2019-11-30T23:00\n",
      "2019-12-01T00:00 2019-12-31T23:00\n",
      "2020-01-01T00:00 2020-01-31T23:00\n",
      "2020-02-01T00:00 2020-02-29T23:00\n",
      "2020-03-01T00:00 2020-03-31T23:00\n",
      "2020-04-01T00:00 2020-04-30T23:00\n",
      "2020-05-01T00:00 2020-05-31T23:00\n",
      "2020-06-01T00:00 2020-06-30T23:00\n",
      "2020-07-01T00:00 2020-07-31T23:00\n",
      "2020-08-01T00:00 2020-08-31T23:00\n",
      "2020-09-01T00:00 2020-09-30T23:00\n",
      "2020-10-01T00:00 2020-10-31T23:00\n",
      "2020-11-01T00:00 2020-11-30T23:00\n",
      "2020-12-01T00:00 2020-12-31T23:00\n",
      "2021-01-01T00:00 2021-01-31T23:00\n",
      "2021-02-01T00:00 2021-02-28T23:00\n",
      "2021-03-01T00:00 2021-03-31T23:00\n",
      "2021-04-01T00:00 2021-04-30T23:00\n",
      "2021-05-01T00:00 2021-05-31T23:00\n",
      "2021-06-01T00:00 2021-06-30T23:00\n",
      "2021-07-01T00:00 2021-07-31T23:00\n",
      "2021-08-01T00:00 2021-08-31T23:00\n",
      "2021-09-01T00:00 2021-09-30T23:00\n",
      "2021-10-01T00:00 2021-10-31T23:00\n",
      "2021-11-01T00:00 2021-11-30T23:00\n",
      "2021-12-01T00:00 2021-12-31T23:00\n",
      "2022-01-01T00:00 2022-01-31T23:00\n",
      "2022-02-01T00:00 2022-02-28T23:00\n",
      "2022-03-01T00:00 2022-03-31T23:00\n",
      "2022-04-01T00:00 2022-04-30T23:00\n",
      "2022-05-01T00:00 2022-05-31T23:00\n",
      "2022-06-01T00:00 2022-06-30T23:00\n",
      "2022-07-01T00:00 2022-07-31T23:00\n",
      "2022-08-01T00:00 2022-08-31T23:00\n",
      "2022-09-01T00:00 2022-09-30T23:00\n",
      "2022-10-01T00:00 2022-10-31T23:00\n",
      "2022-11-01T00:00 2022-11-30T23:00\n",
      "2022-12-01T00:00 2022-12-31T23:00\n",
      "2023-01-01T00:00 2023-01-31T23:00\n",
      "2023-02-01T00:00 2023-02-28T23:00\n",
      "2023-03-01T00:00 2023-03-31T23:00\n",
      "2023-04-01T00:00 2023-04-30T23:00\n",
      "2023-05-01T00:00 2023-05-31T23:00\n",
      "2023-06-01T00:00 2023-06-30T23:00\n",
      "2023-07-01T00:00 2023-07-31T23:00\n",
      "2023-08-01T00:00 2023-08-31T23:00\n",
      "2023-09-01T00:00 2023-09-30T23:00\n",
      "2023-10-01T00:00 2023-10-31T23:00\n",
      "2023-11-01T00:00 2023-11-30T23:00\n",
      "2023-12-01T00:00 2023-12-31T23:00\n",
      "2024-01-01T00:00 2024-01-31T23:00\n",
      "2024-02-01T00:00 2024-02-12T23:00\n"
     ]
    }
   ],
   "source": [
    "### Start Parameters/\n",
    "\n",
    "# Indicator search (look at the csv indicator_description)\n",
    "indicators = ['600','10034','541','543','544','545']\n",
    "indicators_name = ['price_DA', 'generacion_prevista_solar', 'prevision_produccion_eolica', 'generacion_prevista_solar_termic', 'demand_prevista', 'demand_prog']\n",
    "\n",
    "### /End Parameters\n",
    "\n",
    "dataframes_other_pbf = {}\n",
    "\n",
    "for i in range(len(indicators)):\n",
    "    url = URL_BASE + ENDPOINT + indicators[i]\n",
    "    print(indicators[i])\n",
    "\n",
    "    dataframes_other_pbf[indicators_name[i]]=pd.DataFrame()\n",
    "\n",
    "    for date1, date2 in generate_monthly_ranges(start_date, end_date):\n",
    "\n",
    "        print(date1, date2)\n",
    "    \n",
    "        params = {'start_date': date1,\n",
    "                'end_date': date2,\n",
    "                'time_agg': 'avg', #agregate through average (it's in MW)\n",
    "                'time_trunc': 'hour' #aggregate to hourly level\n",
    "        }\n",
    "\n",
    "        request = requests.get(url, headers=headers, params=params)\n",
    "        data = request.json()\n",
    "        aux_df = pd.DataFrame(data['indicator']['values'])\n",
    "        if not aux_df.empty:\n",
    "            aux_df = aux_df[['datetime','datetime_utc', 'geo_id', 'geo_name', 'value']]\n",
    "        dataframes_other_pbf[indicators_name[i]] = pd.concat([dataframes_other_pbf[indicators_name[i]],aux_df],ignore_index=True)\n",
    "\n",
    "#print(dataframes_other_pbf)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6631d64c",
   "metadata": {},
   "source": [
    "### List of PBF disponible\n",
    "\n",
    "All the scheduled productions and id:\\\n",
    "Generación programada PBF Nuclear: 4\\\n",
    "Generación programada PBF Ciclo combinado:9 \\\n",
    "Generación programada PBF Fuel: 10 ----------> ! NO DATA in the API database !\\\n",
    "Generación programada PBF Gas natural: 11 ----------> ! NO DATA in the API database !\\\n",
    "Generación programada PBF solar fotovoltaica: 14\\\n",
    "Generación programada PBF solar termica: 15\\\n",
    "Generación programada PBF Gas Natural cogeneracion: 17\\\n",
    "Generación programada PBF Biomasa: 21\\\n",
    "Generación programada PBF Biogas: 22\\\n",
    "Generación programada PBF UGH + no UGH: 10064\\\n",
    "Generación programada PBF eolica: 10073\\\n",
    "Generación programada PBF Carbón: 10167\\\n",
    "Generación programada PBF total: 10258"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "02d6674a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "4\n",
      "2014-01-01T00:00 2014-01-31T23:00\n",
      "2014-02-01T00:00 2014-02-28T23:00\n",
      "2014-03-01T00:00 2014-03-31T23:00\n",
      "2014-04-01T00:00 2014-04-30T23:00\n",
      "2014-05-01T00:00 2014-05-31T23:00\n",
      "2014-06-01T00:00 2014-06-30T23:00\n",
      "2014-07-01T00:00 2014-07-31T23:00\n",
      "2014-08-01T00:00 2014-08-31T23:00\n",
      "2014-09-01T00:00 2014-09-30T23:00\n",
      "2014-10-01T00:00 2014-10-31T23:00\n",
      "2014-11-01T00:00 2014-11-30T23:00\n",
      "2014-12-01T00:00 2014-12-31T23:00\n",
      "2015-01-01T00:00 2015-01-31T23:00\n",
      "2015-02-01T00:00 2015-02-28T23:00\n",
      "2015-03-01T00:00 2015-03-31T23:00\n",
      "2015-04-01T00:00 2015-04-30T23:00\n",
      "2015-05-01T00:00 2015-05-31T23:00\n",
      "2015-06-01T00:00 2015-06-30T23:00\n",
      "2015-07-01T00:00 2015-07-31T23:00\n",
      "2015-08-01T00:00 2015-08-31T23:00\n",
      "2015-09-01T00:00 2015-09-30T23:00\n",
      "2015-10-01T00:00 2015-10-31T23:00\n",
      "2015-11-01T00:00 2015-11-30T23:00\n",
      "2015-12-01T00:00 2015-12-31T23:00\n",
      "2016-01-01T00:00 2016-01-31T23:00\n",
      "2016-02-01T00:00 2016-02-29T23:00\n",
      "2016-03-01T00:00 2016-03-31T23:00\n",
      "2016-04-01T00:00 2016-04-30T23:00\n",
      "2016-05-01T00:00 2016-05-31T23:00\n",
      "2016-06-01T00:00 2016-06-30T23:00\n",
      "2016-07-01T00:00 2016-07-31T23:00\n",
      "2016-08-01T00:00 2016-08-31T23:00\n",
      "2016-09-01T00:00 2016-09-30T23:00\n",
      "2016-10-01T00:00 2016-10-31T23:00\n",
      "2016-11-01T00:00 2016-11-30T23:00\n",
      "2016-12-01T00:00 2016-12-31T23:00\n",
      "2017-01-01T00:00 2017-01-31T23:00\n",
      "2017-02-01T00:00 2017-02-28T23:00\n",
      "2017-03-01T00:00 2017-03-31T23:00\n",
      "2017-04-01T00:00 2017-04-30T23:00\n",
      "2017-05-01T00:00 2017-05-31T23:00\n",
      "2017-06-01T00:00 2017-06-30T23:00\n",
      "2017-07-01T00:00 2017-07-31T23:00\n",
      "2017-08-01T00:00 2017-08-31T23:00\n",
      "2017-09-01T00:00 2017-09-30T23:00\n",
      "2017-10-01T00:00 2017-10-31T23:00\n",
      "2017-11-01T00:00 2017-11-30T23:00\n",
      "2017-12-01T00:00 2017-12-31T23:00\n",
      "2018-01-01T00:00 2018-01-31T23:00\n",
      "2018-02-01T00:00 2018-02-28T23:00\n",
      "2018-03-01T00:00 2018-03-31T23:00\n",
      "2018-04-01T00:00 2018-04-30T23:00\n",
      "2018-05-01T00:00 2018-05-31T23:00\n",
      "2018-06-01T00:00 2018-06-30T23:00\n",
      "2018-07-01T00:00 2018-07-31T23:00\n",
      "2018-08-01T00:00 2018-08-31T23:00\n",
      "2018-09-01T00:00 2018-09-30T23:00\n",
      "2018-10-01T00:00 2018-10-31T23:00\n",
      "2018-11-01T00:00 2018-11-30T23:00\n",
      "2018-12-01T00:00 2018-12-31T23:00\n",
      "2019-01-01T00:00 2019-01-31T23:00\n",
      "2019-02-01T00:00 2019-02-28T23:00\n",
      "2019-03-01T00:00 2019-03-31T23:00\n",
      "2019-04-01T00:00 2019-04-30T23:00\n",
      "2019-05-01T00:00 2019-05-31T23:00\n",
      "2019-06-01T00:00 2019-06-30T23:00\n",
      "2019-07-01T00:00 2019-07-31T23:00\n",
      "2019-08-01T00:00 2019-08-31T23:00\n",
      "2019-09-01T00:00 2019-09-30T23:00\n",
      "2019-10-01T00:00 2019-10-31T23:00\n",
      "2019-11-01T00:00 2019-11-30T23:00\n",
      "2019-12-01T00:00 2019-12-31T23:00\n",
      "2020-01-01T00:00 2020-01-31T23:00\n",
      "2020-02-01T00:00 2020-02-29T23:00\n",
      "2020-03-01T00:00 2020-03-31T23:00\n",
      "2020-04-01T00:00 2020-04-30T23:00\n",
      "2020-05-01T00:00 2020-05-31T23:00\n",
      "2020-06-01T00:00 2020-06-30T23:00\n",
      "2020-07-01T00:00 2020-07-31T23:00\n",
      "2020-08-01T00:00 2020-08-31T23:00\n",
      "2020-09-01T00:00 2020-09-30T23:00\n",
      "2020-10-01T00:00 2020-10-31T23:00\n",
      "2020-11-01T00:00 2020-11-30T23:00\n",
      "2020-12-01T00:00 2020-12-31T23:00\n",
      "2021-01-01T00:00 2021-01-31T23:00\n",
      "2021-02-01T00:00 2021-02-28T23:00\n",
      "2021-03-01T00:00 2021-03-31T23:00\n",
      "2021-04-01T00:00 2021-04-30T23:00\n",
      "2021-05-01T00:00 2021-05-31T23:00\n",
      "2021-06-01T00:00 2021-06-30T23:00\n",
      "2021-07-01T00:00 2021-07-31T23:00\n",
      "2021-08-01T00:00 2021-08-31T23:00\n",
      "2021-09-01T00:00 2021-09-30T23:00\n",
      "2021-10-01T00:00 2021-10-31T23:00\n",
      "2021-11-01T00:00 2021-11-30T23:00\n",
      "2021-12-01T00:00 2021-12-31T23:00\n",
      "2022-01-01T00:00 2022-01-31T23:00\n",
      "2022-02-01T00:00 2022-02-28T23:00\n",
      "2022-03-01T00:00 2022-03-31T23:00\n",
      "2022-04-01T00:00 2022-04-30T23:00\n",
      "2022-05-01T00:00 2022-05-31T23:00\n",
      "2022-06-01T00:00 2022-06-30T23:00\n",
      "2022-07-01T00:00 2022-07-31T23:00\n",
      "2022-08-01T00:00 2022-08-31T23:00\n",
      "2022-09-01T00:00 2022-09-30T23:00\n",
      "2022-10-01T00:00 2022-10-31T23:00\n",
      "2022-11-01T00:00 2022-11-30T23:00\n",
      "2022-12-01T00:00 2022-12-31T23:00\n",
      "2023-01-01T00:00 2023-01-31T23:00\n",
      "2023-02-01T00:00 2023-02-28T23:00\n",
      "2023-03-01T00:00 2023-03-31T23:00\n",
      "2023-04-01T00:00 2023-04-30T23:00\n",
      "2023-05-01T00:00 2023-05-31T23:00\n",
      "2023-06-01T00:00 2023-06-30T23:00\n",
      "2023-07-01T00:00 2023-07-31T23:00\n",
      "2023-08-01T00:00 2023-08-31T23:00\n",
      "2023-09-01T00:00 2023-09-30T23:00\n",
      "2023-10-01T00:00 2023-10-31T23:00\n",
      "2023-11-01T00:00 2023-11-30T23:00\n",
      "2023-12-01T00:00 2023-12-31T23:00\n",
      "2024-01-01T00:00 2024-01-31T23:00\n",
      "2024-02-01T00:00 2024-02-12T23:00\n",
      "9\n",
      "2014-01-01T00:00 2014-01-31T23:00\n",
      "2014-02-01T00:00 2014-02-28T23:00\n",
      "2014-03-01T00:00 2014-03-31T23:00\n",
      "2014-04-01T00:00 2014-04-30T23:00\n",
      "2014-05-01T00:00 2014-05-31T23:00\n",
      "2014-06-01T00:00 2014-06-30T23:00\n",
      "2014-07-01T00:00 2014-07-31T23:00\n",
      "2014-08-01T00:00 2014-08-31T23:00\n",
      "2014-09-01T00:00 2014-09-30T23:00\n",
      "2014-10-01T00:00 2014-10-31T23:00\n",
      "2014-11-01T00:00 2014-11-30T23:00\n",
      "2014-12-01T00:00 2014-12-31T23:00\n",
      "2015-01-01T00:00 2015-01-31T23:00\n",
      "2015-02-01T00:00 2015-02-28T23:00\n",
      "2015-03-01T00:00 2015-03-31T23:00\n",
      "2015-04-01T00:00 2015-04-30T23:00\n",
      "2015-05-01T00:00 2015-05-31T23:00\n",
      "2015-06-01T00:00 2015-06-30T23:00\n",
      "2015-07-01T00:00 2015-07-31T23:00\n",
      "2015-08-01T00:00 2015-08-31T23:00\n",
      "2015-09-01T00:00 2015-09-30T23:00\n",
      "2015-10-01T00:00 2015-10-31T23:00\n",
      "2015-11-01T00:00 2015-11-30T23:00\n",
      "2015-12-01T00:00 2015-12-31T23:00\n",
      "2016-01-01T00:00 2016-01-31T23:00\n",
      "2016-02-01T00:00 2016-02-29T23:00\n",
      "2016-03-01T00:00 2016-03-31T23:00\n",
      "2016-04-01T00:00 2016-04-30T23:00\n",
      "2016-05-01T00:00 2016-05-31T23:00\n",
      "2016-06-01T00:00 2016-06-30T23:00\n",
      "2016-07-01T00:00 2016-07-31T23:00\n",
      "2016-08-01T00:00 2016-08-31T23:00\n",
      "2016-09-01T00:00 2016-09-30T23:00\n",
      "2016-10-01T00:00 2016-10-31T23:00\n",
      "2016-11-01T00:00 2016-11-30T23:00\n",
      "2016-12-01T00:00 2016-12-31T23:00\n",
      "2017-01-01T00:00 2017-01-31T23:00\n",
      "2017-02-01T00:00 2017-02-28T23:00\n",
      "2017-03-01T00:00 2017-03-31T23:00\n",
      "2017-04-01T00:00 2017-04-30T23:00\n",
      "2017-05-01T00:00 2017-05-31T23:00\n",
      "2017-06-01T00:00 2017-06-30T23:00\n",
      "2017-07-01T00:00 2017-07-31T23:00\n",
      "2017-08-01T00:00 2017-08-31T23:00\n",
      "2017-09-01T00:00 2017-09-30T23:00\n",
      "2017-10-01T00:00 2017-10-31T23:00\n",
      "2017-11-01T00:00 2017-11-30T23:00\n",
      "2017-12-01T00:00 2017-12-31T23:00\n",
      "2018-01-01T00:00 2018-01-31T23:00\n",
      "2018-02-01T00:00 2018-02-28T23:00\n",
      "2018-03-01T00:00 2018-03-31T23:00\n",
      "2018-04-01T00:00 2018-04-30T23:00\n",
      "2018-05-01T00:00 2018-05-31T23:00\n",
      "2018-06-01T00:00 2018-06-30T23:00\n",
      "2018-07-01T00:00 2018-07-31T23:00\n",
      "2018-08-01T00:00 2018-08-31T23:00\n",
      "2018-09-01T00:00 2018-09-30T23:00\n",
      "2018-10-01T00:00 2018-10-31T23:00\n",
      "2018-11-01T00:00 2018-11-30T23:00\n",
      "2018-12-01T00:00 2018-12-31T23:00\n",
      "2019-01-01T00:00 2019-01-31T23:00\n",
      "2019-02-01T00:00 2019-02-28T23:00\n",
      "2019-03-01T00:00 2019-03-31T23:00\n",
      "2019-04-01T00:00 2019-04-30T23:00\n",
      "2019-05-01T00:00 2019-05-31T23:00\n",
      "2019-06-01T00:00 2019-06-30T23:00\n",
      "2019-07-01T00:00 2019-07-31T23:00\n",
      "2019-08-01T00:00 2019-08-31T23:00\n",
      "2019-09-01T00:00 2019-09-30T23:00\n",
      "2019-10-01T00:00 2019-10-31T23:00\n",
      "2019-11-01T00:00 2019-11-30T23:00\n",
      "2019-12-01T00:00 2019-12-31T23:00\n",
      "2020-01-01T00:00 2020-01-31T23:00\n",
      "2020-02-01T00:00 2020-02-29T23:00\n",
      "2020-03-01T00:00 2020-03-31T23:00\n",
      "2020-04-01T00:00 2020-04-30T23:00\n",
      "2020-05-01T00:00 2020-05-31T23:00\n",
      "2020-06-01T00:00 2020-06-30T23:00\n",
      "2020-07-01T00:00 2020-07-31T23:00\n",
      "2020-08-01T00:00 2020-08-31T23:00\n",
      "2020-09-01T00:00 2020-09-30T23:00\n",
      "2020-10-01T00:00 2020-10-31T23:00\n",
      "2020-11-01T00:00 2020-11-30T23:00\n",
      "2020-12-01T00:00 2020-12-31T23:00\n",
      "2021-01-01T00:00 2021-01-31T23:00\n",
      "2021-02-01T00:00 2021-02-28T23:00\n",
      "2021-03-01T00:00 2021-03-31T23:00\n",
      "2021-04-01T00:00 2021-04-30T23:00\n",
      "2021-05-01T00:00 2021-05-31T23:00\n",
      "2021-06-01T00:00 2021-06-30T23:00\n",
      "2021-07-01T00:00 2021-07-31T23:00\n",
      "2021-08-01T00:00 2021-08-31T23:00\n",
      "2021-09-01T00:00 2021-09-30T23:00\n",
      "2021-10-01T00:00 2021-10-31T23:00\n",
      "2021-11-01T00:00 2021-11-30T23:00\n",
      "2021-12-01T00:00 2021-12-31T23:00\n",
      "2022-01-01T00:00 2022-01-31T23:00\n",
      "2022-02-01T00:00 2022-02-28T23:00\n",
      "2022-03-01T00:00 2022-03-31T23:00\n",
      "2022-04-01T00:00 2022-04-30T23:00\n",
      "2022-05-01T00:00 2022-05-31T23:00\n",
      "2022-06-01T00:00 2022-06-30T23:00\n",
      "2022-07-01T00:00 2022-07-31T23:00\n",
      "2022-08-01T00:00 2022-08-31T23:00\n",
      "2022-09-01T00:00 2022-09-30T23:00\n",
      "2022-10-01T00:00 2022-10-31T23:00\n",
      "2022-11-01T00:00 2022-11-30T23:00\n",
      "2022-12-01T00:00 2022-12-31T23:00\n",
      "2023-01-01T00:00 2023-01-31T23:00\n",
      "2023-02-01T00:00 2023-02-28T23:00\n",
      "2023-03-01T00:00 2023-03-31T23:00\n",
      "2023-04-01T00:00 2023-04-30T23:00\n",
      "2023-05-01T00:00 2023-05-31T23:00\n",
      "2023-06-01T00:00 2023-06-30T23:00\n",
      "2023-07-01T00:00 2023-07-31T23:00\n",
      "2023-08-01T00:00 2023-08-31T23:00\n",
      "2023-09-01T00:00 2023-09-30T23:00\n",
      "2023-10-01T00:00 2023-10-31T23:00\n",
      "2023-11-01T00:00 2023-11-30T23:00\n",
      "2023-12-01T00:00 2023-12-31T23:00\n",
      "2024-01-01T00:00 2024-01-31T23:00\n",
      "2024-02-01T00:00 2024-02-12T23:00\n",
      "10\n",
      "2014-01-01T00:00 2014-01-31T23:00\n",
      "2014-02-01T00:00 2014-02-28T23:00\n",
      "2014-03-01T00:00 2014-03-31T23:00\n",
      "2014-04-01T00:00 2014-04-30T23:00\n",
      "2014-05-01T00:00 2014-05-31T23:00\n",
      "2014-06-01T00:00 2014-06-30T23:00\n",
      "2014-07-01T00:00 2014-07-31T23:00\n",
      "2014-08-01T00:00 2014-08-31T23:00\n",
      "2014-09-01T00:00 2014-09-30T23:00\n",
      "2014-10-01T00:00 2014-10-31T23:00\n",
      "2014-11-01T00:00 2014-11-30T23:00\n",
      "2014-12-01T00:00 2014-12-31T23:00\n",
      "2015-01-01T00:00 2015-01-31T23:00\n",
      "2015-02-01T00:00 2015-02-28T23:00\n",
      "2015-03-01T00:00 2015-03-31T23:00\n",
      "2015-04-01T00:00 2015-04-30T23:00\n",
      "2015-05-01T00:00 2015-05-31T23:00\n",
      "2015-06-01T00:00 2015-06-30T23:00\n",
      "2015-07-01T00:00 2015-07-31T23:00\n",
      "2015-08-01T00:00 2015-08-31T23:00\n",
      "2015-09-01T00:00 2015-09-30T23:00\n",
      "2015-10-01T00:00 2015-10-31T23:00\n",
      "2015-11-01T00:00 2015-11-30T23:00\n",
      "2015-12-01T00:00 2015-12-31T23:00\n",
      "2016-01-01T00:00 2016-01-31T23:00\n",
      "2016-02-01T00:00 2016-02-29T23:00\n",
      "2016-03-01T00:00 2016-03-31T23:00\n",
      "2016-04-01T00:00 2016-04-30T23:00\n",
      "2016-05-01T00:00 2016-05-31T23:00\n",
      "2016-06-01T00:00 2016-06-30T23:00\n",
      "2016-07-01T00:00 2016-07-31T23:00\n",
      "2016-08-01T00:00 2016-08-31T23:00\n",
      "2016-09-01T00:00 2016-09-30T23:00\n",
      "2016-10-01T00:00 2016-10-31T23:00\n",
      "2016-11-01T00:00 2016-11-30T23:00\n",
      "2016-12-01T00:00 2016-12-31T23:00\n",
      "2017-01-01T00:00 2017-01-31T23:00\n",
      "2017-02-01T00:00 2017-02-28T23:00\n",
      "2017-03-01T00:00 2017-03-31T23:00\n",
      "2017-04-01T00:00 2017-04-30T23:00\n",
      "2017-05-01T00:00 2017-05-31T23:00\n",
      "2017-06-01T00:00 2017-06-30T23:00\n",
      "2017-07-01T00:00 2017-07-31T23:00\n",
      "2017-08-01T00:00 2017-08-31T23:00\n",
      "2017-09-01T00:00 2017-09-30T23:00\n",
      "2017-10-01T00:00 2017-10-31T23:00\n",
      "2017-11-01T00:00 2017-11-30T23:00\n",
      "2017-12-01T00:00 2017-12-31T23:00\n",
      "2018-01-01T00:00 2018-01-31T23:00\n",
      "2018-02-01T00:00 2018-02-28T23:00\n",
      "2018-03-01T00:00 2018-03-31T23:00\n",
      "2018-04-01T00:00 2018-04-30T23:00\n",
      "2018-05-01T00:00 2018-05-31T23:00\n",
      "2018-06-01T00:00 2018-06-30T23:00\n",
      "2018-07-01T00:00 2018-07-31T23:00\n",
      "2018-08-01T00:00 2018-08-31T23:00\n",
      "2018-09-01T00:00 2018-09-30T23:00\n",
      "2018-10-01T00:00 2018-10-31T23:00\n",
      "2018-11-01T00:00 2018-11-30T23:00\n",
      "2018-12-01T00:00 2018-12-31T23:00\n",
      "2019-01-01T00:00 2019-01-31T23:00\n",
      "2019-02-01T00:00 2019-02-28T23:00\n",
      "2019-03-01T00:00 2019-03-31T23:00\n",
      "2019-04-01T00:00 2019-04-30T23:00\n",
      "2019-05-01T00:00 2019-05-31T23:00\n",
      "2019-06-01T00:00 2019-06-30T23:00\n",
      "2019-07-01T00:00 2019-07-31T23:00\n",
      "2019-08-01T00:00 2019-08-31T23:00\n",
      "2019-09-01T00:00 2019-09-30T23:00\n",
      "2019-10-01T00:00 2019-10-31T23:00\n",
      "2019-11-01T00:00 2019-11-30T23:00\n",
      "2019-12-01T00:00 2019-12-31T23:00\n",
      "2020-01-01T00:00 2020-01-31T23:00\n",
      "2020-02-01T00:00 2020-02-29T23:00\n",
      "2020-03-01T00:00 2020-03-31T23:00\n",
      "2020-04-01T00:00 2020-04-30T23:00\n",
      "2020-05-01T00:00 2020-05-31T23:00\n",
      "2020-06-01T00:00 2020-06-30T23:00\n",
      "2020-07-01T00:00 2020-07-31T23:00\n",
      "2020-08-01T00:00 2020-08-31T23:00\n",
      "2020-09-01T00:00 2020-09-30T23:00\n",
      "2020-10-01T00:00 2020-10-31T23:00\n",
      "2020-11-01T00:00 2020-11-30T23:00\n",
      "2020-12-01T00:00 2020-12-31T23:00\n",
      "2021-01-01T00:00 2021-01-31T23:00\n",
      "2021-02-01T00:00 2021-02-28T23:00\n",
      "2021-03-01T00:00 2021-03-31T23:00\n",
      "2021-04-01T00:00 2021-04-30T23:00\n",
      "2021-05-01T00:00 2021-05-31T23:00\n",
      "2021-06-01T00:00 2021-06-30T23:00\n",
      "2021-07-01T00:00 2021-07-31T23:00\n",
      "2021-08-01T00:00 2021-08-31T23:00\n",
      "2021-09-01T00:00 2021-09-30T23:00\n",
      "2021-10-01T00:00 2021-10-31T23:00\n",
      "2021-11-01T00:00 2021-11-30T23:00\n",
      "2021-12-01T00:00 2021-12-31T23:00\n",
      "2022-01-01T00:00 2022-01-31T23:00\n",
      "2022-02-01T00:00 2022-02-28T23:00\n",
      "2022-03-01T00:00 2022-03-31T23:00\n",
      "2022-04-01T00:00 2022-04-30T23:00\n",
      "2022-05-01T00:00 2022-05-31T23:00\n",
      "2022-06-01T00:00 2022-06-30T23:00\n",
      "2022-07-01T00:00 2022-07-31T23:00\n",
      "2022-08-01T00:00 2022-08-31T23:00\n",
      "2022-09-01T00:00 2022-09-30T23:00\n",
      "2022-10-01T00:00 2022-10-31T23:00\n",
      "2022-11-01T00:00 2022-11-30T23:00\n",
      "2022-12-01T00:00 2022-12-31T23:00\n",
      "2023-01-01T00:00 2023-01-31T23:00\n",
      "2023-02-01T00:00 2023-02-28T23:00\n",
      "2023-03-01T00:00 2023-03-31T23:00\n",
      "2023-04-01T00:00 2023-04-30T23:00\n",
      "2023-05-01T00:00 2023-05-31T23:00\n",
      "2023-06-01T00:00 2023-06-30T23:00\n",
      "2023-07-01T00:00 2023-07-31T23:00\n",
      "2023-08-01T00:00 2023-08-31T23:00\n",
      "2023-09-01T00:00 2023-09-30T23:00\n",
      "2023-10-01T00:00 2023-10-31T23:00\n",
      "2023-11-01T00:00 2023-11-30T23:00\n",
      "2023-12-01T00:00 2023-12-31T23:00\n",
      "2024-01-01T00:00 2024-01-31T23:00\n",
      "2024-02-01T00:00 2024-02-12T23:00\n",
      "11\n",
      "2014-01-01T00:00 2014-01-31T23:00\n",
      "2014-02-01T00:00 2014-02-28T23:00\n",
      "2014-03-01T00:00 2014-03-31T23:00\n",
      "2014-04-01T00:00 2014-04-30T23:00\n",
      "2014-05-01T00:00 2014-05-31T23:00\n",
      "2014-06-01T00:00 2014-06-30T23:00\n",
      "2014-07-01T00:00 2014-07-31T23:00\n",
      "2014-08-01T00:00 2014-08-31T23:00\n",
      "2014-09-01T00:00 2014-09-30T23:00\n",
      "2014-10-01T00:00 2014-10-31T23:00\n",
      "2014-11-01T00:00 2014-11-30T23:00\n",
      "2014-12-01T00:00 2014-12-31T23:00\n",
      "2015-01-01T00:00 2015-01-31T23:00\n",
      "2015-02-01T00:00 2015-02-28T23:00\n",
      "2015-03-01T00:00 2015-03-31T23:00\n",
      "2015-04-01T00:00 2015-04-30T23:00\n",
      "2015-05-01T00:00 2015-05-31T23:00\n",
      "2015-06-01T00:00 2015-06-30T23:00\n",
      "2015-07-01T00:00 2015-07-31T23:00\n",
      "2015-08-01T00:00 2015-08-31T23:00\n",
      "2015-09-01T00:00 2015-09-30T23:00\n",
      "2015-10-01T00:00 2015-10-31T23:00\n",
      "2015-11-01T00:00 2015-11-30T23:00\n",
      "2015-12-01T00:00 2015-12-31T23:00\n",
      "2016-01-01T00:00 2016-01-31T23:00\n",
      "2016-02-01T00:00 2016-02-29T23:00\n",
      "2016-03-01T00:00 2016-03-31T23:00\n",
      "2016-04-01T00:00 2016-04-30T23:00\n",
      "2016-05-01T00:00 2016-05-31T23:00\n",
      "2016-06-01T00:00 2016-06-30T23:00\n",
      "2016-07-01T00:00 2016-07-31T23:00\n",
      "2016-08-01T00:00 2016-08-31T23:00\n",
      "2016-09-01T00:00 2016-09-30T23:00\n",
      "2016-10-01T00:00 2016-10-31T23:00\n",
      "2016-11-01T00:00 2016-11-30T23:00\n",
      "2016-12-01T00:00 2016-12-31T23:00\n",
      "2017-01-01T00:00 2017-01-31T23:00\n",
      "2017-02-01T00:00 2017-02-28T23:00\n",
      "2017-03-01T00:00 2017-03-31T23:00\n",
      "2017-04-01T00:00 2017-04-30T23:00\n",
      "2017-05-01T00:00 2017-05-31T23:00\n",
      "2017-06-01T00:00 2017-06-30T23:00\n",
      "2017-07-01T00:00 2017-07-31T23:00\n",
      "2017-08-01T00:00 2017-08-31T23:00\n",
      "2017-09-01T00:00 2017-09-30T23:00\n",
      "2017-10-01T00:00 2017-10-31T23:00\n",
      "2017-11-01T00:00 2017-11-30T23:00\n",
      "2017-12-01T00:00 2017-12-31T23:00\n",
      "2018-01-01T00:00 2018-01-31T23:00\n",
      "2018-02-01T00:00 2018-02-28T23:00\n",
      "2018-03-01T00:00 2018-03-31T23:00\n",
      "2018-04-01T00:00 2018-04-30T23:00\n",
      "2018-05-01T00:00 2018-05-31T23:00\n",
      "2018-06-01T00:00 2018-06-30T23:00\n",
      "2018-07-01T00:00 2018-07-31T23:00\n",
      "2018-08-01T00:00 2018-08-31T23:00\n",
      "2018-09-01T00:00 2018-09-30T23:00\n",
      "2018-10-01T00:00 2018-10-31T23:00\n",
      "2018-11-01T00:00 2018-11-30T23:00\n",
      "2018-12-01T00:00 2018-12-31T23:00\n",
      "2019-01-01T00:00 2019-01-31T23:00\n",
      "2019-02-01T00:00 2019-02-28T23:00\n",
      "2019-03-01T00:00 2019-03-31T23:00\n",
      "2019-04-01T00:00 2019-04-30T23:00\n",
      "2019-05-01T00:00 2019-05-31T23:00\n",
      "2019-06-01T00:00 2019-06-30T23:00\n",
      "2019-07-01T00:00 2019-07-31T23:00\n",
      "2019-08-01T00:00 2019-08-31T23:00\n",
      "2019-09-01T00:00 2019-09-30T23:00\n",
      "2019-10-01T00:00 2019-10-31T23:00\n",
      "2019-11-01T00:00 2019-11-30T23:00\n",
      "2019-12-01T00:00 2019-12-31T23:00\n",
      "2020-01-01T00:00 2020-01-31T23:00\n",
      "2020-02-01T00:00 2020-02-29T23:00\n",
      "2020-03-01T00:00 2020-03-31T23:00\n",
      "2020-04-01T00:00 2020-04-30T23:00\n",
      "2020-05-01T00:00 2020-05-31T23:00\n",
      "2020-06-01T00:00 2020-06-30T23:00\n",
      "2020-07-01T00:00 2020-07-31T23:00\n",
      "2020-08-01T00:00 2020-08-31T23:00\n",
      "2020-09-01T00:00 2020-09-30T23:00\n",
      "2020-10-01T00:00 2020-10-31T23:00\n",
      "2020-11-01T00:00 2020-11-30T23:00\n",
      "2020-12-01T00:00 2020-12-31T23:00\n",
      "2021-01-01T00:00 2021-01-31T23:00\n",
      "2021-02-01T00:00 2021-02-28T23:00\n",
      "2021-03-01T00:00 2021-03-31T23:00\n",
      "2021-04-01T00:00 2021-04-30T23:00\n",
      "2021-05-01T00:00 2021-05-31T23:00\n",
      "2021-06-01T00:00 2021-06-30T23:00\n",
      "2021-07-01T00:00 2021-07-31T23:00\n",
      "2021-08-01T00:00 2021-08-31T23:00\n",
      "2021-09-01T00:00 2021-09-30T23:00\n",
      "2021-10-01T00:00 2021-10-31T23:00\n",
      "2021-11-01T00:00 2021-11-30T23:00\n",
      "2021-12-01T00:00 2021-12-31T23:00\n",
      "2022-01-01T00:00 2022-01-31T23:00\n",
      "2022-02-01T00:00 2022-02-28T23:00\n",
      "2022-03-01T00:00 2022-03-31T23:00\n",
      "2022-04-01T00:00 2022-04-30T23:00\n",
      "2022-05-01T00:00 2022-05-31T23:00\n",
      "2022-06-01T00:00 2022-06-30T23:00\n",
      "2022-07-01T00:00 2022-07-31T23:00\n",
      "2022-08-01T00:00 2022-08-31T23:00\n",
      "2022-09-01T00:00 2022-09-30T23:00\n",
      "2022-10-01T00:00 2022-10-31T23:00\n",
      "2022-11-01T00:00 2022-11-30T23:00\n",
      "2022-12-01T00:00 2022-12-31T23:00\n",
      "2023-01-01T00:00 2023-01-31T23:00\n",
      "2023-02-01T00:00 2023-02-28T23:00\n",
      "2023-03-01T00:00 2023-03-31T23:00\n",
      "2023-04-01T00:00 2023-04-30T23:00\n",
      "2023-05-01T00:00 2023-05-31T23:00\n",
      "2023-06-01T00:00 2023-06-30T23:00\n",
      "2023-07-01T00:00 2023-07-31T23:00\n",
      "2023-08-01T00:00 2023-08-31T23:00\n",
      "2023-09-01T00:00 2023-09-30T23:00\n",
      "2023-10-01T00:00 2023-10-31T23:00\n",
      "2023-11-01T00:00 2023-11-30T23:00\n",
      "2023-12-01T00:00 2023-12-31T23:00\n",
      "2024-01-01T00:00 2024-01-31T23:00\n",
      "2024-02-01T00:00 2024-02-12T23:00\n",
      "14\n",
      "2014-01-01T00:00 2014-01-31T23:00\n",
      "2014-02-01T00:00 2014-02-28T23:00\n",
      "2014-03-01T00:00 2014-03-31T23:00\n",
      "2014-04-01T00:00 2014-04-30T23:00\n",
      "2014-05-01T00:00 2014-05-31T23:00\n",
      "2014-06-01T00:00 2014-06-30T23:00\n",
      "2014-07-01T00:00 2014-07-31T23:00\n",
      "2014-08-01T00:00 2014-08-31T23:00\n",
      "2014-09-01T00:00 2014-09-30T23:00\n",
      "2014-10-01T00:00 2014-10-31T23:00\n",
      "2014-11-01T00:00 2014-11-30T23:00\n",
      "2014-12-01T00:00 2014-12-31T23:00\n",
      "2015-01-01T00:00 2015-01-31T23:00\n",
      "2015-02-01T00:00 2015-02-28T23:00\n",
      "2015-03-01T00:00 2015-03-31T23:00\n",
      "2015-04-01T00:00 2015-04-30T23:00\n",
      "2015-05-01T00:00 2015-05-31T23:00\n",
      "2015-06-01T00:00 2015-06-30T23:00\n",
      "2015-07-01T00:00 2015-07-31T23:00\n",
      "2015-08-01T00:00 2015-08-31T23:00\n",
      "2015-09-01T00:00 2015-09-30T23:00\n",
      "2015-10-01T00:00 2015-10-31T23:00\n",
      "2015-11-01T00:00 2015-11-30T23:00\n",
      "2015-12-01T00:00 2015-12-31T23:00\n",
      "2016-01-01T00:00 2016-01-31T23:00\n",
      "2016-02-01T00:00 2016-02-29T23:00\n",
      "2016-03-01T00:00 2016-03-31T23:00\n",
      "2016-04-01T00:00 2016-04-30T23:00\n",
      "2016-05-01T00:00 2016-05-31T23:00\n",
      "2016-06-01T00:00 2016-06-30T23:00\n",
      "2016-07-01T00:00 2016-07-31T23:00\n",
      "2016-08-01T00:00 2016-08-31T23:00\n",
      "2016-09-01T00:00 2016-09-30T23:00\n",
      "2016-10-01T00:00 2016-10-31T23:00\n",
      "2016-11-01T00:00 2016-11-30T23:00\n",
      "2016-12-01T00:00 2016-12-31T23:00\n",
      "2017-01-01T00:00 2017-01-31T23:00\n",
      "2017-02-01T00:00 2017-02-28T23:00\n",
      "2017-03-01T00:00 2017-03-31T23:00\n",
      "2017-04-01T00:00 2017-04-30T23:00\n",
      "2017-05-01T00:00 2017-05-31T23:00\n",
      "2017-06-01T00:00 2017-06-30T23:00\n",
      "2017-07-01T00:00 2017-07-31T23:00\n",
      "2017-08-01T00:00 2017-08-31T23:00\n",
      "2017-09-01T00:00 2017-09-30T23:00\n",
      "2017-10-01T00:00 2017-10-31T23:00\n",
      "2017-11-01T00:00 2017-11-30T23:00\n",
      "2017-12-01T00:00 2017-12-31T23:00\n",
      "2018-01-01T00:00 2018-01-31T23:00\n",
      "2018-02-01T00:00 2018-02-28T23:00\n",
      "2018-03-01T00:00 2018-03-31T23:00\n",
      "2018-04-01T00:00 2018-04-30T23:00\n",
      "2018-05-01T00:00 2018-05-31T23:00\n",
      "2018-06-01T00:00 2018-06-30T23:00\n",
      "2018-07-01T00:00 2018-07-31T23:00\n",
      "2018-08-01T00:00 2018-08-31T23:00\n",
      "2018-09-01T00:00 2018-09-30T23:00\n",
      "2018-10-01T00:00 2018-10-31T23:00\n",
      "2018-11-01T00:00 2018-11-30T23:00\n",
      "2018-12-01T00:00 2018-12-31T23:00\n",
      "2019-01-01T00:00 2019-01-31T23:00\n",
      "2019-02-01T00:00 2019-02-28T23:00\n",
      "2019-03-01T00:00 2019-03-31T23:00\n",
      "2019-04-01T00:00 2019-04-30T23:00\n",
      "2019-05-01T00:00 2019-05-31T23:00\n",
      "2019-06-01T00:00 2019-06-30T23:00\n",
      "2019-07-01T00:00 2019-07-31T23:00\n",
      "2019-08-01T00:00 2019-08-31T23:00\n",
      "2019-09-01T00:00 2019-09-30T23:00\n",
      "2019-10-01T00:00 2019-10-31T23:00\n",
      "2019-11-01T00:00 2019-11-30T23:00\n",
      "2019-12-01T00:00 2019-12-31T23:00\n",
      "2020-01-01T00:00 2020-01-31T23:00\n",
      "2020-02-01T00:00 2020-02-29T23:00\n",
      "2020-03-01T00:00 2020-03-31T23:00\n",
      "2020-04-01T00:00 2020-04-30T23:00\n",
      "2020-05-01T00:00 2020-05-31T23:00\n",
      "2020-06-01T00:00 2020-06-30T23:00\n",
      "2020-07-01T00:00 2020-07-31T23:00\n",
      "2020-08-01T00:00 2020-08-31T23:00\n",
      "2020-09-01T00:00 2020-09-30T23:00\n",
      "2020-10-01T00:00 2020-10-31T23:00\n",
      "2020-11-01T00:00 2020-11-30T23:00\n",
      "2020-12-01T00:00 2020-12-31T23:00\n",
      "2021-01-01T00:00 2021-01-31T23:00\n",
      "2021-02-01T00:00 2021-02-28T23:00\n",
      "2021-03-01T00:00 2021-03-31T23:00\n",
      "2021-04-01T00:00 2021-04-30T23:00\n",
      "2021-05-01T00:00 2021-05-31T23:00\n",
      "2021-06-01T00:00 2021-06-30T23:00\n",
      "2021-07-01T00:00 2021-07-31T23:00\n",
      "2021-08-01T00:00 2021-08-31T23:00\n",
      "2021-09-01T00:00 2021-09-30T23:00\n",
      "2021-10-01T00:00 2021-10-31T23:00\n",
      "2021-11-01T00:00 2021-11-30T23:00\n",
      "2021-12-01T00:00 2021-12-31T23:00\n",
      "2022-01-01T00:00 2022-01-31T23:00\n",
      "2022-02-01T00:00 2022-02-28T23:00\n",
      "2022-03-01T00:00 2022-03-31T23:00\n",
      "2022-04-01T00:00 2022-04-30T23:00\n",
      "2022-05-01T00:00 2022-05-31T23:00\n",
      "2022-06-01T00:00 2022-06-30T23:00\n",
      "2022-07-01T00:00 2022-07-31T23:00\n",
      "2022-08-01T00:00 2022-08-31T23:00\n",
      "2022-09-01T00:00 2022-09-30T23:00\n",
      "2022-10-01T00:00 2022-10-31T23:00\n",
      "2022-11-01T00:00 2022-11-30T23:00\n",
      "2022-12-01T00:00 2022-12-31T23:00\n",
      "2023-01-01T00:00 2023-01-31T23:00\n",
      "2023-02-01T00:00 2023-02-28T23:00\n",
      "2023-03-01T00:00 2023-03-31T23:00\n",
      "2023-04-01T00:00 2023-04-30T23:00\n",
      "2023-05-01T00:00 2023-05-31T23:00\n",
      "2023-06-01T00:00 2023-06-30T23:00\n",
      "2023-07-01T00:00 2023-07-31T23:00\n",
      "2023-08-01T00:00 2023-08-31T23:00\n",
      "2023-09-01T00:00 2023-09-30T23:00\n",
      "2023-10-01T00:00 2023-10-31T23:00\n",
      "2023-11-01T00:00 2023-11-30T23:00\n",
      "2023-12-01T00:00 2023-12-31T23:00\n",
      "2024-01-01T00:00 2024-01-31T23:00\n",
      "2024-02-01T00:00 2024-02-12T23:00\n",
      "15\n",
      "2014-01-01T00:00 2014-01-31T23:00\n",
      "2014-02-01T00:00 2014-02-28T23:00\n",
      "2014-03-01T00:00 2014-03-31T23:00\n",
      "2014-04-01T00:00 2014-04-30T23:00\n",
      "2014-05-01T00:00 2014-05-31T23:00\n",
      "2014-06-01T00:00 2014-06-30T23:00\n",
      "2014-07-01T00:00 2014-07-31T23:00\n",
      "2014-08-01T00:00 2014-08-31T23:00\n",
      "2014-09-01T00:00 2014-09-30T23:00\n",
      "2014-10-01T00:00 2014-10-31T23:00\n",
      "2014-11-01T00:00 2014-11-30T23:00\n",
      "2014-12-01T00:00 2014-12-31T23:00\n",
      "2015-01-01T00:00 2015-01-31T23:00\n",
      "2015-02-01T00:00 2015-02-28T23:00\n",
      "2015-03-01T00:00 2015-03-31T23:00\n",
      "2015-04-01T00:00 2015-04-30T23:00\n",
      "2015-05-01T00:00 2015-05-31T23:00\n",
      "2015-06-01T00:00 2015-06-30T23:00\n",
      "2015-07-01T00:00 2015-07-31T23:00\n",
      "2015-08-01T00:00 2015-08-31T23:00\n",
      "2015-09-01T00:00 2015-09-30T23:00\n",
      "2015-10-01T00:00 2015-10-31T23:00\n",
      "2015-11-01T00:00 2015-11-30T23:00\n",
      "2015-12-01T00:00 2015-12-31T23:00\n",
      "2016-01-01T00:00 2016-01-31T23:00\n",
      "2016-02-01T00:00 2016-02-29T23:00\n",
      "2016-03-01T00:00 2016-03-31T23:00\n",
      "2016-04-01T00:00 2016-04-30T23:00\n",
      "2016-05-01T00:00 2016-05-31T23:00\n",
      "2016-06-01T00:00 2016-06-30T23:00\n",
      "2016-07-01T00:00 2016-07-31T23:00\n",
      "2016-08-01T00:00 2016-08-31T23:00\n",
      "2016-09-01T00:00 2016-09-30T23:00\n",
      "2016-10-01T00:00 2016-10-31T23:00\n",
      "2016-11-01T00:00 2016-11-30T23:00\n",
      "2016-12-01T00:00 2016-12-31T23:00\n",
      "2017-01-01T00:00 2017-01-31T23:00\n",
      "2017-02-01T00:00 2017-02-28T23:00\n",
      "2017-03-01T00:00 2017-03-31T23:00\n",
      "2017-04-01T00:00 2017-04-30T23:00\n",
      "2017-05-01T00:00 2017-05-31T23:00\n",
      "2017-06-01T00:00 2017-06-30T23:00\n",
      "2017-07-01T00:00 2017-07-31T23:00\n",
      "2017-08-01T00:00 2017-08-31T23:00\n",
      "2017-09-01T00:00 2017-09-30T23:00\n",
      "2017-10-01T00:00 2017-10-31T23:00\n",
      "2017-11-01T00:00 2017-11-30T23:00\n",
      "2017-12-01T00:00 2017-12-31T23:00\n",
      "2018-01-01T00:00 2018-01-31T23:00\n",
      "2018-02-01T00:00 2018-02-28T23:00\n",
      "2018-03-01T00:00 2018-03-31T23:00\n",
      "2018-04-01T00:00 2018-04-30T23:00\n",
      "2018-05-01T00:00 2018-05-31T23:00\n",
      "2018-06-01T00:00 2018-06-30T23:00\n",
      "2018-07-01T00:00 2018-07-31T23:00\n",
      "2018-08-01T00:00 2018-08-31T23:00\n",
      "2018-09-01T00:00 2018-09-30T23:00\n",
      "2018-10-01T00:00 2018-10-31T23:00\n",
      "2018-11-01T00:00 2018-11-30T23:00\n",
      "2018-12-01T00:00 2018-12-31T23:00\n",
      "2019-01-01T00:00 2019-01-31T23:00\n",
      "2019-02-01T00:00 2019-02-28T23:00\n",
      "2019-03-01T00:00 2019-03-31T23:00\n",
      "2019-04-01T00:00 2019-04-30T23:00\n",
      "2019-05-01T00:00 2019-05-31T23:00\n",
      "2019-06-01T00:00 2019-06-30T23:00\n",
      "2019-07-01T00:00 2019-07-31T23:00\n",
      "2019-08-01T00:00 2019-08-31T23:00\n",
      "2019-09-01T00:00 2019-09-30T23:00\n",
      "2019-10-01T00:00 2019-10-31T23:00\n",
      "2019-11-01T00:00 2019-11-30T23:00\n",
      "2019-12-01T00:00 2019-12-31T23:00\n",
      "2020-01-01T00:00 2020-01-31T23:00\n",
      "2020-02-01T00:00 2020-02-29T23:00\n",
      "2020-03-01T00:00 2020-03-31T23:00\n",
      "2020-04-01T00:00 2020-04-30T23:00\n",
      "2020-05-01T00:00 2020-05-31T23:00\n",
      "2020-06-01T00:00 2020-06-30T23:00\n",
      "2020-07-01T00:00 2020-07-31T23:00\n",
      "2020-08-01T00:00 2020-08-31T23:00\n",
      "2020-09-01T00:00 2020-09-30T23:00\n",
      "2020-10-01T00:00 2020-10-31T23:00\n",
      "2020-11-01T00:00 2020-11-30T23:00\n",
      "2020-12-01T00:00 2020-12-31T23:00\n",
      "2021-01-01T00:00 2021-01-31T23:00\n",
      "2021-02-01T00:00 2021-02-28T23:00\n",
      "2021-03-01T00:00 2021-03-31T23:00\n",
      "2021-04-01T00:00 2021-04-30T23:00\n",
      "2021-05-01T00:00 2021-05-31T23:00\n",
      "2021-06-01T00:00 2021-06-30T23:00\n",
      "2021-07-01T00:00 2021-07-31T23:00\n",
      "2021-08-01T00:00 2021-08-31T23:00\n",
      "2021-09-01T00:00 2021-09-30T23:00\n",
      "2021-10-01T00:00 2021-10-31T23:00\n",
      "2021-11-01T00:00 2021-11-30T23:00\n",
      "2021-12-01T00:00 2021-12-31T23:00\n",
      "2022-01-01T00:00 2022-01-31T23:00\n",
      "2022-02-01T00:00 2022-02-28T23:00\n",
      "2022-03-01T00:00 2022-03-31T23:00\n",
      "2022-04-01T00:00 2022-04-30T23:00\n",
      "2022-05-01T00:00 2022-05-31T23:00\n",
      "2022-06-01T00:00 2022-06-30T23:00\n",
      "2022-07-01T00:00 2022-07-31T23:00\n",
      "2022-08-01T00:00 2022-08-31T23:00\n",
      "2022-09-01T00:00 2022-09-30T23:00\n",
      "2022-10-01T00:00 2022-10-31T23:00\n",
      "2022-11-01T00:00 2022-11-30T23:00\n",
      "2022-12-01T00:00 2022-12-31T23:00\n",
      "2023-01-01T00:00 2023-01-31T23:00\n",
      "2023-02-01T00:00 2023-02-28T23:00\n",
      "2023-03-01T00:00 2023-03-31T23:00\n",
      "2023-04-01T00:00 2023-04-30T23:00\n",
      "2023-05-01T00:00 2023-05-31T23:00\n",
      "2023-06-01T00:00 2023-06-30T23:00\n",
      "2023-07-01T00:00 2023-07-31T23:00\n",
      "2023-08-01T00:00 2023-08-31T23:00\n",
      "2023-09-01T00:00 2023-09-30T23:00\n",
      "2023-10-01T00:00 2023-10-31T23:00\n",
      "2023-11-01T00:00 2023-11-30T23:00\n",
      "2023-12-01T00:00 2023-12-31T23:00\n",
      "2024-01-01T00:00 2024-01-31T23:00\n",
      "2024-02-01T00:00 2024-02-12T23:00\n",
      "17\n",
      "2014-01-01T00:00 2014-01-31T23:00\n",
      "2014-02-01T00:00 2014-02-28T23:00\n",
      "2014-03-01T00:00 2014-03-31T23:00\n",
      "2014-04-01T00:00 2014-04-30T23:00\n",
      "2014-05-01T00:00 2014-05-31T23:00\n",
      "2014-06-01T00:00 2014-06-30T23:00\n",
      "2014-07-01T00:00 2014-07-31T23:00\n",
      "2014-08-01T00:00 2014-08-31T23:00\n",
      "2014-09-01T00:00 2014-09-30T23:00\n",
      "2014-10-01T00:00 2014-10-31T23:00\n",
      "2014-11-01T00:00 2014-11-30T23:00\n",
      "2014-12-01T00:00 2014-12-31T23:00\n",
      "2015-01-01T00:00 2015-01-31T23:00\n",
      "2015-02-01T00:00 2015-02-28T23:00\n",
      "2015-03-01T00:00 2015-03-31T23:00\n",
      "2015-04-01T00:00 2015-04-30T23:00\n",
      "2015-05-01T00:00 2015-05-31T23:00\n",
      "2015-06-01T00:00 2015-06-30T23:00\n",
      "2015-07-01T00:00 2015-07-31T23:00\n",
      "2015-08-01T00:00 2015-08-31T23:00\n",
      "2015-09-01T00:00 2015-09-30T23:00\n",
      "2015-10-01T00:00 2015-10-31T23:00\n",
      "2015-11-01T00:00 2015-11-30T23:00\n"
     ]
    }
   ],
   "source": [
    "### Start Parameters/\n",
    "\n",
    "# Indicator search (look at the csv indicator_description)\n",
    "indicators = ['4','9','10','11','14','15','17','21','22','10064','10073','10167','10258']\n",
    "indicators_name = ['pbf_nuclear', 'pbf_ciclo_comb', 'pbf_fuel', 'pbf_gas_nat', 'pbf_solar_fot', 'pbf_solar_term', 'pbf_gaz_cog', 'pbf_biomass', 'pbf_biogas', 'pbf_UGH_no_UGH', 'pbf_eolica', 'pbf_carbon', 'pbf_total']\n",
    "\n",
    "### /End Parameters\n",
    "\n",
    "dataframes_pbf = {}\n",
    "\n",
    "for i in range(len(indicators)):\n",
    "    url = URL_BASE + ENDPOINT + indicators[i]\n",
    "    print(indicators[i])\n",
    "\n",
    "    dataframes_pbf[indicators_name[i]]=pd.DataFrame()\n",
    "\n",
    "    for date1, date2 in generate_monthly_ranges(start_date, end_date):\n",
    "\n",
    "        print(date1, date2)\n",
    "    \n",
    "        params = {'start_date': date1,\n",
    "                'end_date': date2,\n",
    "                'time_agg': 'avg', #agregate through average (it's in MW)\n",
    "                'time_trunc': 'hour' #aggregate to hourly level\n",
    "        }\n",
    "\n",
    "        request = requests.get(url, headers=headers, params=params)\n",
    "        data = request.json()\n",
    "        aux_df = pd.DataFrame(data['indicator']['values'])\n",
    "        if not aux_df.empty:\n",
    "            aux_df = aux_df[['datetime','datetime_utc', 'geo_id', 'geo_name', 'value']]\n",
    "        dataframes_pbf[indicators_name[i]] = pd.concat([dataframes_pbf[indicators_name[i]],aux_df],ignore_index=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f8b9dcf0",
   "metadata": {},
   "source": [
    "## Group and Select all the dataframes\n",
    "\n",
    "Now every dataframes will be accessible thanks dataframes_dictionnary. You can access to every dataframe by his name. You can also choose to unselect some of them."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2da86393",
   "metadata": {},
   "outputs": [],
   "source": [
    "removed_dataframes = [\"pbf_fuel\", \"pbf_gas_nat\"]\n",
    "\n",
    "dataframes_dictionnary = {}\n",
    "dataframes_dictionnary.update(dataframes_other_pbf)\n",
    "dataframes_dictionnary.update(dataframes_pbf)\n",
    "\n",
    "for deselect_dataframe in removed_dataframes:\n",
    "    del  dataframes_dictionnary[deselect_dataframe]\n",
    "\n",
    "print(dataframes_dictionnary)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e08387d0",
   "metadata": {},
   "source": [
    "## Create CSV for all this dataframes\n",
    "\n",
    "This can be usefull if you have an other code than this .ipynb \\\n",
    "You just have to extract those csv in dataframe in you own code."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "43866c4b",
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "os.makedirs(\"datas\", exist_ok=True)\n",
    "\n",
    "for key in dataframes_dictionnary:\n",
    "    dataframes_dictionnary[key].to_csv(f\"datas/{key}.csv\", index=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d1d9983c",
   "metadata": {},
   "source": [
    "## Pre-processing of datasets\n",
    "Change to datetime and also remove the timezone, keeping the local timezone, not the UTC one"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "45982d8c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Change to datetime\n",
    "for keys in dataframes_dictionnary:\n",
    "    dataframes_dictionnary[keys]['datetime'] = pd.to_datetime(dataframes_dictionnary[keys]['datetime'])\n",
    "\n",
    "#Remove timezone info\n",
    "for keys in dataframes_dictionnary:\n",
    "    dataframes_dictionnary[keys]['datetime'] = dataframes_dictionnary[keys]['datetime'].apply(lambda x: x.replace(tzinfo=None))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "44f0eb31",
   "metadata": {},
   "source": [
    "Check for duplicates, they appear on October, when summer time shifts to winter time"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ba4329ab",
   "metadata": {},
   "outputs": [],
   "source": [
    "for keys in dataframes_dictionnary:\n",
    "    duplicates = dataframes_dictionnary[keys][dataframes_dictionnary[keys].duplicated(subset='datetime',keep=False)] \n",
    "    print(duplicates)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d8001c98",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Remove duplicates, keep last value\n",
    "for keys in dataframes_dictionnary:\n",
    "    dataframes_dictionnary[keys] = dataframes_dictionnary[keys].drop_duplicates(subset='datetime',keep='last')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "89a43412",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Set datetime as index\n",
    "for keys in dataframes_dictionnary:\n",
    "    dataframes_dictionnary[keys] = dataframes_dictionnary[keys].set_index('datetime')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c64841e9",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Give a commun date_range\n",
    "date_range = pd.date_range(start=dataframes_dictionnary[\"price_DA\"].index.min(), end=dataframes_dictionnary[\"price_DA\"].index.max(), freq='H')\n",
    "print(date_range)\n",
    "\n",
    "for keys in dataframes_dictionnary:\n",
    "    dataframes_dictionnary[keys] = dataframes_dictionnary[keys].reindex(date_range)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "64c2c248",
   "metadata": {},
   "source": [
    "Some graphs of daily hourly profiles just to see if the data makes sense..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "885103ac",
   "metadata": {},
   "outputs": [],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Set up a 3xlen(dataframes_dictionnary) subplot grid\n",
    "fig, axs = plt.subplots(3, len(dataframes_dictionnary)//3+1, figsize=(25, 6))\n",
    "fig.suptitle(\"Average Hourly Profile of a Day for Different DataFrames\")\n",
    "\n",
    "# Loop over each DataFrame, calculate the average hourly profile, and plot\n",
    "col = 0\n",
    "row = 0\n",
    "for keys in dataframes_dictionnary:\n",
    "    # Group by hour of the day and calculate the mean for each hour\n",
    "    average_hourly_profile = dataframes_dictionnary[keys].groupby(dataframes_dictionnary[keys].index.hour)['value'].mean()\n",
    "    \n",
    "    # Plot on the corresponding subplot\n",
    "    axs[row, col].plot(average_hourly_profile, marker='o', color='b')\n",
    "    axs[row, col].set_title(keys)\n",
    "    axs[row, col].set_xlabel(\"Hour of the Day\")\n",
    "    axs[row, col].set_xticks(range(0, 24))\n",
    "    axs[row, col].grid(True)\n",
    "    col += 1\n",
    "    if col > 5:\n",
    "        col = 0\n",
    "        row += 1\n",
    "\n",
    "# Set a common y-label for all subplots\n",
    "for ax in axs[:, 0]:  # Pour chaque ligne de la première colonne\n",
    "    ax.set_ylabel(\"Average Value\")\n",
    "\n",
    "plt.tight_layout(rect=[0, 0, 1, 0.95])  # Adjust layout to fit title\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9d0a87e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Rename the 'value' columns in each DataFrame to reflect their data source\n",
    "for keys in dataframes_dictionnary:\n",
    "    dataframes_dictionnary[keys] = dataframes_dictionnary[keys].rename(columns={'value': f'{keys}'})\n",
    "\n",
    "# Concatenate the DataFrames, aligning on the index of prices_DA_full\n",
    "dataframes_to_concat = [dataframes_dictionnary['price_DA']['price_DA']]  # Start with the prices DataFrame\n",
    "\n",
    "# Add the renamed DataFrames from the dataframes_dictionnary to the list\n",
    "for keys in dataframes_dictionnary:\n",
    "    if keys != 'price_DA':\n",
    "        dataframes_to_concat.extend([dataframes_dictionnary[keys][keys]])\n",
    "\n",
    "full_data = pd.concat(dataframes_to_concat, axis=1)\n",
    "\n",
    "# Display the concatenated DataFrame\n",
    "full_data"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "351df744",
   "metadata": {},
   "source": [
    "Check NaNs and drop them, sometimes Nans also occur when shifting from winter time to summer time"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c23257d7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Check NaNs\n",
    "full_data.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ac84bf09",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Drop them\n",
    "full_data.dropna(inplace=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1c4b9141",
   "metadata": {},
   "source": [
    "# END OF DATA PREPARATION\n",
    "___"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "68e38966",
   "metadata": {},
   "source": [
    "Initial plots looking for some correlations..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "983a1395",
   "metadata": {},
   "outputs": [],
   "source": [
    "from pandas.plotting import scatter_matrix\n",
    "\n",
    "scatter_matrix(full_data, alpha=0.2, figsize=(14, 14), diagonal='kde', range_padding=0.05)\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f1d809e0",
   "metadata": {},
   "outputs": [],
   "source": [
    "import seaborn as sns\n",
    "sns.pairplot(full_data, corner=True)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bc2484a6",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Calculation of correlation coefficients\n",
    "corr = full_data.iloc[:,0:].corr(method='spearman')  # method{‘pearson’, ‘kendall’, ‘spearman’} \n",
    "corr"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e7521225",
   "metadata": {},
   "source": [
    "Create new time features from the dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1f781ed8",
   "metadata": {},
   "outputs": [],
   "source": [
    "full_data['year'] = full_data.index.year\n",
    "full_data['month'] = full_data.index.month\n",
    "full_data['hour'] = full_data.index.hour\n",
    "full_data"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e1818910",
   "metadata": {},
   "source": [
    "# Histogram plotting of prices\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1fe02474",
   "metadata": {},
   "outputs": [],
   "source": [
    "histogram = full_data['day_ahead_price'].hist(xlabelsize=10, ylabelsize=10, bins=100, figsize=(15, 10))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d15a5bee",
   "metadata": {},
   "source": [
    "For each year"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9db04ef1",
   "metadata": {},
   "outputs": [],
   "source": [
    "years = range(2014, 2025)  # Including 2024\n",
    "\n",
    "plt.figure(figsize=(15, 10))\n",
    "\n",
    "for year in years:\n",
    "    plt.subplot(3, 4, year - 2013)  # Create a 3x4 grid of subplots\n",
    "    plt.hist(full_data[full_data['year'] == year]['day_ahead_price'], bins=10, alpha=0.7, color='blue', edgecolor='black')\n",
    "    plt.title(f'Histogram for {year}')\n",
    "    plt.xlabel('Price (EUR/MWh)')\n",
    "    plt.ylabel('Frequency')\n",
    "    plt.xlim(left=0)  # Adjust the x-axis limit for better visibility\n",
    "    plt.grid(axis='y', alpha=0.75)\n",
    "\n",
    "plt.tight_layout()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5f32ac28",
   "metadata": {},
   "source": [
    "Density plots, note that the histogram varies for each year, with lower prices in 2024. Probably more recent data will be more relevant than later one..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3cfcdd12",
   "metadata": {},
   "outputs": [],
   "source": [
    "plt.figure(figsize=(15, 10))\n",
    "\n",
    "for year in years:\n",
    "    plt.subplot(3, 4, year - 2013)  # Create a 3x4 grid of subplots\n",
    "    sns.kdeplot(data=full_data[full_data['year'] == year]['day_ahead_price'], color='blue', label='Weekday', fill=True, alpha=0.1)\n",
    "    plt.title(f'Density plot for {year}')\n",
    "    plt.xlabel('Price (EUR/MWh)')\n",
    "    plt.ylabel('Frequency')\n",
    "    plt.xlim(left=0)  # Adjust the x-axis limit for better visibility\n",
    "    plt.grid(axis='y', alpha=0.75)\n",
    "\n",
    "plt.tight_layout()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7f86ded0",
   "metadata": {},
   "source": [
    "## Boxplot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f78e8d6f",
   "metadata": {},
   "outputs": [],
   "source": [
    "boxplot_attributes = full_data['day_ahead_price'].plot(kind='box', subplots=True, layout=(4, 3), figsize=(11, 11),\n",
    "                                 sharex=False, sharey=False, fontsize=10)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6a3d3050",
   "metadata": {},
   "source": [
    "Delete outliers with IQR method (only for prices for now)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b8396d87",
   "metadata": {},
   "outputs": [],
   "source": [
    "def remove_outliers_iqr(data, column):\n",
    "    Q1 = data[column].quantile(0.25)\n",
    "    Q3 = data[column].quantile(0.75)\n",
    "    IQR = Q3 - Q1\n",
    "    \n",
    "    lower_bound = Q1 - 1.5 * IQR\n",
    "    upper_bound = Q3 + 1.5 * IQR\n",
    "    \n",
    "    return data[(data[column] >= lower_bound) & (data[column] <= upper_bound)]\n",
    "\n",
    "prices_no_outliers_iqr = remove_outliers_iqr(full_data, 'day_ahead_price')\n",
    "\n",
    "\n",
    "atributos_boxplot = prices_no_outliers_iqr.plot(kind='box', subplots=True, layout=(4, 3), figsize=(11, 11),\n",
    "                                 sharex=False, sharey=False, fontsize=10)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "da25c9a6",
   "metadata": {},
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
